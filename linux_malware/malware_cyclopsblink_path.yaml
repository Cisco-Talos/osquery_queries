references: [ "https://www.cisa.gov/uscert/ncas/alerts/aa22-054a" ]
title: "CyclopsBlink Path"
os: [ linux ]
tactics: [ execution ]
techniques: [ command-and-scripting-interpreter ]
query: SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, "unixepoch","UTC") AS last_access_time, DATETIME(f.mtime, "unixepoch", "UTC") AS last_modified, DATETIME(f.ctime, "unixepoch", "UTC") AS last_status_change_time, DATETIME(f.btime, "unixepoch", "UTC") AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE ((f.path LIKE "%pending%" AND (f.filename LIKE regex_match(f.filename, "%010lu_%06d_%03d_p1", 0) OR f.filename LIKE regex_match(f.filename, "test_%d_%d_%d_%d_%d_%d", 0) OR f.filename LIKE regex_match(f.filename, "WGUpgrade-dl\.new", 0) OR f.filename LIKE regex_match(f.filename, "install_upgraded", 0))) OR (f.directory LIKE "/etc/wg" AND (f.filename LIKE regex_match(f.filename, "configd-hash.xml", 0) OR f.filename LIKE regex_match(f.filename, "config.xml",0))) OR (f.directory LIKE "/var/tmp" AND f.filename LIKE "a.tmp") OR (f.directory LIKE regex_match(f.directory, "%s", 0) AND (f.filename LIKE "rootfs_cfg" OR f.filename LIKE "214688dsf46")));
description: |
  This query detects a file path used by the CyclopsBlink botnet. CyclopsBlink is a large scale botnet compiled for PPC. It has modules to download/upload files, extract device information, and update itself. It is associated with recent events surrounding Ukraine.
