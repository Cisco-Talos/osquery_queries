Malware MuddyWater VBScript Registry Persistence:
  query: SELECT key, path, name, data, DATETIME(mtime, "unixepoch", "UTC") AS last_modified
    FROM registry WHERE key LIKE "HKEY_USERS\S-%\SOFTWARE\Microsoft\Windows\CurrentVersion\Run"
    AND data LIKE regex_match(data,"^rundll32\.exe\s+pcwutl\.dll,LaunchApplication.+\\Links\\[A-Za-z]+\.vbs$",0);
  interval: 86400
  snapshot: true
  description: MuddyWater is an Advanced Persistent Threat (APT) recently attributed
    to the Iranian Ministry of Intelligence and Security (MOIS) by the U.S. Cyber
    Command. Multiple attack and infection chains have recently been used by this APT
    group, utilizing malicious PDFs, XLS files, and Windows executables. One such
    persistence technique involves setting a Registry Run key to load the pcwutl.dll
    LOLBIN.
  references:
  - 9991b185c9e9732501e0c2bd841e32a4022f0735a0527150bc8e64ac363d409d
  mitre_tactics:
  - Persistence: TA0003
  mitre_techniques:
  - Boot or Logon Autostart Execution: T1547
  platform:
  - windows
