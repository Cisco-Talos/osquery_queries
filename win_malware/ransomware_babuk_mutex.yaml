ransomware_babuk_mutex:
  query: SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type="Mutant"
    AND (object_name="DoYouWantToHaveSexWithCuongDong" OR object_name="DoYouWantToHaveSexWithCoungDong");
  interval: 86400
  snapshot: true
  description: Babuk ransomware uses its own implementation of SHA256 hashing, ChaCha8
    encryption, and Elliptic-curve Diffieâ€“Hellman (ECDH) key generation and exchange
    algorithm to protect encryption keys and encrypt files. It leverages multi-threaded
    encryption and Windows Restart Manager to cleanly close applications that have
    a file locked, thus freeing it up for encryption. This signature looks for a mutex
    name associated with the malware.
  references:
  - bd26b65807026a70909d38c48f2a9e0f8730b1126e80ef078e29e10379722b49
  mitre_tactics:
  - impact: TA0040
  mitre_techniques:
  - data-encrypted-for-impact: T1486
  platform:
  - windows
