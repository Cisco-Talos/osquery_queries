malware_solarmarker_filepath:
  description: Solarmarker is a malware campaign conducted with the objective to steal
    sensitive data such as web browser credentials and key strokes from the infected
    machine. The campaign uses planetry-like naming conventions such as Jupyter, Mars
    and Uran to name their malware modules and variants. The file detected contains
    an identifier that is used to uniquely identify each infected machine.
  interval: 86400
  mitre_tactics:
  - Credential Access: TA0006
  mitre_techniques:
  - Credentials from Web Browsers: T1503
  platform:
  - windows
  query: SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size,
    DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch',
    'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time,
    DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT
    JOIN hash h ON f.path=h.path WHERE f.path LIKE '%:\Users\_%\AppData\Roaming\solarmarker.dat';
  references:
  - https://www.virustotal.com/gui/file/b29e6b570a96224c874b9fae36b65db9e9b8c6e1081f18cf87e56bd996470c22/detection
  snapshot: true
