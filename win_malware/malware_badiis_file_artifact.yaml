BadIIS File Artifact:
  query: SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, 
    DATETIME(f.atime, 'unixepoch', 'UTC') AS last_access_time, 
    DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, 
    DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, 
    DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type 
    FROM file f LEFT JOIN hash h ON f.path = h.path 
    WHERE ( f.path LIKE '\ProgramData\%%' 
    AND (f.filename LIKE 'IISMODEx86.dll' 
    OR f.filename LIKE 'IISMODEx64.dll')) 
    OR (f.path LIKE '\Windows\Microsoft.NET\Framework%%' 
    AND f.filename LIKE 'HttpResetModule%.dll');
  interval: 86400
  snapshot: true
  description: BadIIS is a malware with search engine optimization fraud capabilities, which are fake, 
    sometimes malicious, websites that users can see at the top when they look for certain terms on 
    search engines. BadIIS usually installs its files in ProgramData, inside directories with names of 
    legitimate software as an attempt to avoid detection. 
  references:
  - c747d509ecfed834d147bdf7390903e0670e6624b7921ffcb5c73390af615850
  mitre_tactics:
  - Persistence: TA0003
  - Defense Evasion: TA0005
  mitre_techniques:
  - IIS Components: T1505.004
  - Match Legitimate Name or Location: T1036.005
  platform:
  - windows
