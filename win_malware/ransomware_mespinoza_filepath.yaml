ransomware_mespinoza_filepath:
  query: 'SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime,
    "unixepoch","UTC") AS last_access_time, DATETIME(f.mtime, "unixepoch", "UTC")
    AS last_modified, DATETIME(f.ctime, "unixepoch", "UTC") AS last_status_change_time,
    DATETIME(f.btime, "unixepoch", "UTC") AS creation_time, f.type FROM file f
    LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE "%Readme.README"; '
  interval: 86400
  snapshot: true
  description: Mespinoza, also known as Pysa, is a ransomware known for encrypting
    files on the infected system, usually appending the "pysa" extension although
    some variants might use other extensions, such as "locked". Mespinoza is also
    known for storing the ransom note in theregistry, to make it persistent. After
    the infection it deletes itself using a dropped batch file. This ransomware generates
    a key for every file it encrypts.
  references:
  - https://www.virustotal.com/gui/file/af99b482eb0b3ff976fa719bf0079da15f62a6c203911655ed93e52ae05c4ac8/detection
  mitre_tactics:
  - Impact: TA0040
  mitre_techniques:
  - Data Encrypted for Impact: T1486
  platform:
  - windows
