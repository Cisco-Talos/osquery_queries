malware_bandook_filepath:
  description: Bandook is a Remote Access Trojan (RAT) known for spying corporate
    networks in Latin America. Attacks associated with Bandook usually start with
    emails that contain a PDF with a malicious link as an attachment. The link downloads
    a compressed archive with the dropper that eventually injects Bandook into an
    Internet Explorer process. Bandook collects information about the victim and sends
    it to its Command and Control (C&C) server. The most recent Bandook variants are
    also capable of recording sound, taking screenshots, using the victim's webcam
    and manipulating programs like Skype and TeamViewer.
  interval: 86400
  mitre_tactics:
  - Execution: TA0002
  mitre_techniques:
  - User Execution: T1204
  - Process Injection: T1055
  platform:
  - windows
  query: SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size,
    DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch',
    'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time,
    DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time FROM file f JOIN hash h
    ON f.path=h.path WHERE f.path LIKE 'C:\Users\%\AppData\Roaming\%%' AND f.directory
    LIKE regex_match(f.directory, '.*Roaming\\[a-z]{20}', 0) AND f.filename LIKE regex_match(f.filename,
    '[a-z]{20}\.exe', 0);
  references:
  - www.virustotal.com/gui/file/51367cf1a79f11c5801c47f1fbe68c765c1e90602cb7ff49dc00af5e2701c9d5/detection
  - www.virustotal.com/gui/file/d3e7b5be903eb9a596b9b2b78e5dd28390c6aadb8bdd4ea1ba3d896d99fa0057/detection
  snapshot: true
