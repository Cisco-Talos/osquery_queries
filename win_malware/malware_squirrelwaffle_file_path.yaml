malware_squirrelwaffle_file_path:
  query: SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size,
    DATETIME(f.atime, "unixepoch", "UTC") AS last_access_time, DATETIME(f.mtime, "unixepoch",
    "UTC") AS last_modified, DATETIME(f.ctime, "unixepoch", "UTC") AS last_status_change_time,
    DATETIME(f.btime, "unixepoch", "UTC") AS creation_time, f.type FROM file f LEFT
    JOIN hash h ON f.path=h.path WHERE (f.directory LIKE "C:\ProgramData\" AND f.filename
    LIKE regex_match(f.filename,"^www[0-9]\.dll$",0)) OR (f.directory LIKE "C:\Datop\"
    AND f.filename LIKE regex_match(f.filename,"^test[0-9]?\.test$",0));
  interval: 86400
  snapshot: true
  description: SquirrelWaffle provides threat actors with an initial foothold onto
    systems and their network environments that can then be used to facilitate further
    compromise or additional malware infections depending on how adversaries choose
    to attempt to monetize their access. In many cases, these infections are also
    being used to deliver and infect systems with other malware like Qakbot and the
    penetration-testing tool Cobalt Strike.
  references:
  - 5401103614610b1e109c674b2f90732e0a056be81dbdd8886324aa2d41f0cf2a
  mitre_tactics:
  - defense-evasion: TA0005
  mitre_techniques:
  - signed-binary-proxy-execution: T1218
  platform:
  - windows
