malware_nanocorerat_filepath:
  query: SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size,
    DATETIME(f.atime, "unixepoch","UTC") AS last_access_time, DATETIME(f.mtime, "unixepoch",
    "UTC") AS last_modified, DATETIME(f.ctime, "unixepoch", "UTC") AS last_status_change_time,
    DATETIME(f.btime, "unixepoch", "UTC") AS creation_time FROM file f JOIN hash h
    ON f.path=h.path WHERE f.path LIKE "C:\Users\%\AppData\Roaming\%%\run.dat" AND
    f.directory LIKE regex_match(f.directory, ".*AppData\\Roaming\\[A-F0-9]{8}-[A-F0-9]{4}-[A-F0-9]{4}-[A-F0-9]{4}-[A-F0-9]{12}",
    0) AND f.filename LIKE "run.dat";
  interval: 86400
  snapshot: true
  description: A filepath associated with NanoCore RAT was detected. NanoCore RAT
    is a Remote Access Trojan (RAT) that has many capabilities including arbitrary
    command execution, file exfiltration, keylogging, and interacting with peripherals
    such as webcams.
  platform:
  - windows
