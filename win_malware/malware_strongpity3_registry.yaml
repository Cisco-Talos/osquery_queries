malware_strongpity3_registry:
  query: 'SELECT key, path, name, data, datetime(mtime, ''unixepoch'', ''UTC'') as
    last_modified FROM registry WHERE ((key LIKE ''%\SYSTEM\CurrentControlSet\Services\dusntask''
    OR key LIKE ''%\System\CurrentControlSet\Services\PickerSrv'' OR key LIKE ''%\System\CurrentControlSet\Services\netplviz'')
    AND name LIKE ''%ImagePath'') OR (key LIKE ''HKEY_USERS\%\Software\Microsoft\Windows\CurrentVersion\Run''
    AND name = ''OperaSyncService''); '
  interval: 86400
  snapshot: true
  description: This query detects the presence of a registry key/dataname combination
    known to be created during StrongPity3 execution. StrongPity3 is a spyware capable
    of detecting and altering anti-malware protections and exfiltration data. It uses
    the Registry to achieve persistence.
  mitre_tactics:
  - Persistence: TA0003
  mitre_techniques:
  - Modify Registry: T1112
  platform:
  - windows
