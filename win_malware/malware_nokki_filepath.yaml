malware_nokki_filepath:
  query: 'SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime,
    "unixepoch","UTC") AS last_access_time, DATETIME(f.mtime, "unixepoch", "UTC")
    AS last_modified, DATETIME(f.ctime, "unixepoch", "UTC") AS last_status_change_time,
    DATETIME(f.btime, "unixepoch", "UTC") AS creation_time, f.type FROM file f
    LEFT JOIN hash h ON f.path=h.path WHERE (f.path LIKE "C:\Users\%\AppData\Roaming\Microsoft\Windows\Start
    Menu\Programs\Startup" OR f.path LIKE "C:\Users\%\AppData\Local\MicroSoft Update%"
    OR f.path LIKE "C:\Users\%\AppData\Local\Temp") AND (f.filename LIKE "Antdule.lnk"
    OR f.filename LIKE "svServiceUpdate.exe" OR f.filename LIKE "uplog.tmp"); '
  interval: 86400
  snapshot: true
  description: KONNI and NOKKI are Remote Administration Tools (RATs) involved in
    a series of attacks focused on politically-motivated victims in the Korean peninsula,
    Eurasia and Southeast Asia. Due to code similarities and overlapping infrastructure,
    researchers suspect NOKKI and KONNI were developed by the same malicious actors.
    The payload is usually delivered via emails with attachments.
  references:
  - https://www.virustotal.com/gui/file/9bf634ff0bc7c69ffceb75f9773c198944d907ba822c02c44c83e997b88eeabd/detection
  - https://www.virustotal.com/gui/file/9b1a21d352ededd057ee3a965907126dd11d13474028a429d91e2349b1f00e10/detection
  mitre_tactics:
  - Execution: TA0002
  - Defense Evasion: TA0005
  mitre_techniques:
  - Masquerading: T1036
  - User Execution: T1204
  platform:
  - windows
