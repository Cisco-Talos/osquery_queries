malware_obliquerat_filepath:
  query: 'SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime,"unixepoch","UTC")
    AS last_access_time, DATETIME(f.mtime, "unixepoch", "UTC") AS last_modified,
    DATETIME(f.ctime, "unixepoch", "UTC") AS last_status_change_time,DATETIME(f.btime,
    "unixepoch", "UTC") AS creation_time, f.type FROM file f LEFT JOIN hash h
    ON f.path=h.path WHERE (f.path LIKE "%ProgramData\System\%\%" AND f.path LIKE
    regex_match(f.path,"^[A-Z]:\\ProgramData\\System\\(Dump|Recycled)\\[^\\]+",0))
    OR (f.path LIKE "%ProgramData\tsc\%" AND f.path LIKE regex_match(f.path,"^[A-Z]:\\ProgramData\\tsc\\[^\\]+",0))
    OR (f.path LIKE "%ProgramData\wsc\%" AND f.path LIKE regex_match(f.path,"^[A-Z]:\\ProgramData\\wsc\\[^\\]+",0))
    OR (f.path LIKE "%ProgramData\DirecTree.txt" AND f.path LIKE regex_match(f.path,"^[A-Z]:\\ProgramData\\DirecTree.txt$",0)); '
  interval: 86400
  snapshot: true
  description: ObliqueRAT is a remote access trojan (RAT) which provides the adversary
    controlling it with access to the files on disk, webcam, screenshots as well as
    the ability to install additional malware. This family of RATs is also known to
    exfiltrate files on removable drives and from the recycling bin.
  mitre_tactics:
  - Collection: TA0009
  mitre_techniques:
  - Automated Collection: T1119
  platform:
  - windows
