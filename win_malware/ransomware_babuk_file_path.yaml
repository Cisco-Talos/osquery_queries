ransomware_babuk_file_path:
  query: SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size,
    DATETIME(f.atime, "unixepoch", "UTC") AS last_access_time, DATETIME(f.mtime, "unixepoch",
    "UTC") AS last_modified, DATETIME(f.ctime, "unixepoch", "UTC") AS last_status_change_time,
    DATETIME(f.btime, "unixepoch", "UTC") AS creation_time, f.type FROM file f LEFT
    JOIN hash h ON f.path=h.path WHERE (f.path LIKE "%.babyk") OR (f.path LIKE "%.__NIST_K571__");
  interval: 86400
  snapshot: true
  description: Babuk ransomware uses its own implementation of SHA256 hashing, ChaCha8
    encryption, and Elliptic-curve Diffieâ€“Hellman (ECDH) key generation and exchange
    algorithm to protect encryption keys and encrypt files. It leverages multi-threaded
    encryption and Windows Restart Manager to cleanly close applications that have
    a file locked, thus freeing it up for encryption. This signature looks for file
    extensions that are associated with the malware.
  references:
  - bd26b65807026a70909d38c48f2a9e0f8730b1126e80ef078e29e10379722b49
  mitre_tactics:
  - impact: TA0040
  mitre_techniques:
  - data-encrypted-for-impact: T1486
  platform:
  - windows
