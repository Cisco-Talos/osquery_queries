malware_file_enumerator_filepath:
  description: 'A file path associated with a file enumerator, commonly used by the
    Netwire RAT, was created. A file enumerator loops through the different directories
    and files in a system. It is often used during the reconnaissance phase of an
    infection. Attackers look for specific file extensions within user directories
    and send the found paths to a command and control server. '
  interval: 86400
  mitre_tactics:
  - Execution: TA0002
  - Defense Evasion: TA0005
  - Persistence: TA0003
  mitre_techniques:
  - User Execution: T1204
  - Masquerading: T1036
  - Registry Run Keys / Startup Folder: T1060
  platform:
  - windows
  query: SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size,
    DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch',
    'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time,
    DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time FROM file f JOIN hash h
    ON f.path=h.path WHERE f.directory LIKE 'C:\Users\%\AppData\Roaming\Microsoft\Windows\Start
    Menu\Programs\Startup' AND f.filename LIKE 'Ping.exe';
  references:
  - www.virustotal.com/gui/file/df780cccc044ee861af1089eb7498a612e6d740a609e500fd3c2a35d2c9c31e0/detection
  snapshot: true
