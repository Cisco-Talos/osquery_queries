Mars Stealer Legitimate DLL Download:
  query: SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, "unixepoch", "UTC") AS last_access_time, DATETIME(f.mtime, "unixepoch", "UTC") AS last_modified, DATETIME(f.ctime, "unixepoch", "UTC") AS last_status_change_time, DATETIME(f.btime, "unixepoch", "UTC") AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE f.directory="C:\ProgramData\" AND LOWER(f.filename) IN ("freebl3.dll", "mozglue.dll", "msvcp140.dll", "nss3.dll", "softokn3.dll", "sqlite3.dll", "vcruntime140.dll");
  interval: 86400
  snapshot: true
  description: |
    Mars Stealer attempts to steal valuable information from an infected host. Its
    capabilities have an emphasis on stealing information regarding cryptocurrency,
    while it also maintains the ability to steal browser data, files and system
    information. Mars Stealer also employs several evasion techniques to avoid
    detection and communicates with C2 over SSL. This query detects the stealer's
    download and subsequent DLL drops to disk for legitimate modules used to
    nefariously collect information.
  references:
  - www.virustotal.com/gui/file/afa0662aa8eac0e607a9ffc85aa0bdfc570198dcb82dccdb40d0a459e12769dc/detection
  mitre_tactics:
  - evasion: TA0002
  techniques:
  - shared-modules: T1129
  platform:
  - windows
