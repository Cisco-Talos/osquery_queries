ransomware_darkside_filepath:
  query: 'SELECT DISTINCT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime,
    "unixepoch","UTC") AS last_access_time, DATETIME(f.mtime, "unixepoch", "UTC")
    AS last_modified, DATETIME(f.ctime, "unixepoch", "UTC") AS last_status_change_time,
    DATETIME(f.btime, "unixepoch", "UTC") AS creation_time, f.type FROM file f
    LEFT JOIN hash h ON f.path=h.path WHERE ((f.path LIKE "C:\Users\%%" AND f.filename LIKE
    regex_match(f.filename, "README\.[a-zA-Z0-9]{8}\.TXT", 0)) OR (f.path LIKE "C:\Users\%%"
    AND f.filename LIKE regex_match(f.filename, "LOG\.[a-zA-Z0-9]{8}\.TXT", 0))); '
  interval: 86400
  snapshot: true
  description: A filepath associated with DarkSide was created. DarkSide is a ransomware capable of
    encrypting local drives and network shares. It is also capable of encrypting a specific directory
    that is passed to it through a command-line argument.
  references:
  - https://www.virustotal.com/gui/file/9cee5522a7ca2bfca7cd3d9daba23e9a30deb6205f56c12045839075f7627297
  mitre_tactics:
  - Execution: TA0002
  - Privilege Escalation: TA0004
  - Defense Evasion: TA0005
  - Impact: TA0040
  mitre_techniques:
  - Access Token Manipulation: T1134
  - Data Encrypted for Impact: T1486
  - Inhibit System Recovery: T1490
  platform:
  - windows
