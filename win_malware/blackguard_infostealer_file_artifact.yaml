BlackGuard Infostealer File Artifact:
  query: SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size,
    DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch',
    'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time,
    DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time FROM file f JOIN hash h
    ON f.path = h.path WHERE f.directory LIKE 'C:\Users\%\AppData\%%' AND f.directory
    = regex_match(f.directory, '[a-zA-Z]:\Users\[^\]+\AppData\(Roaming|Local(\Temp)?)\([^\]+\)*',
    0) AND f.filename = regex_match(f.filename, '\([a-zA-Z\s]{4,32}\)_\[[a-zA-Z0-9]{4,32}\]\.rar',
    0);
  interval: 86400
  snapshot: true
  description: An attempt to create a directory or file associated with BlackGuard
    Infostealer was detected. BlackGuard is an information stealer designed to steal
    sensitive information such as browser histories, credentials and cookies, and
    cryptocurrency wallets. It will also steal configurations and credentials of various
    applications such as Virtual Private Network (VPN), Virtual Network Computing
    (VNC) and File Transfer Protocol (FTP).
  references:
  - www.virustotal.com/gui/file/8b6a82bd10fc3cab378e9c2023bee639ed81d1ee02fb882b8601f451466d76bf
  mitre_tactics:
  - execution: TA0002
  mitre_techniques: []
  platform:
  - windows
