malware_pipemon_filepath:
  query: 'SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode,
    f.size, DATETIME(f.atime, "unixepoch","UTC") AS last_access_time, DATETIME(f.mtime,
    "unixepoch", "UTC") AS last_modified, DATETIME(f.ctime, "unixepoch", "UTC") AS
    last_status_change_time, DATETIME(f.btime, "unixepoch", "UTC") AS creation_time
    FROM file f JOIN hash h ON f.path=h.path WHERE (f.path LIKE "C:\Windows\System32\spool\prtprocs\x64\EntAppsvc.dll"
    OR f.path LIKE "C:\Windows\System32\spool\prtprocs\x64\epcprtsvc.dll" OR f.path
    LIKE "C:\Windows\System32\spool\prtprocs\x64\DEment.dll" OR f.path LIKE "C:\Windows\System32\spool\prtprocs\x64\Interactive.dll"); '
  interval: 86400
  snapshot: true
  description: A filepath associated with PipeMon Trojan was detected. PipeMon Trojan
    is a modular backdoor whose payloads are DLLs and are stored where Windows Print
    Processors are located. After the payloads are placed in this location, they are
    registered as Print Processors.
  mitre_tactics:
  - Execution: TA0002
  - Persistence: TA0003
  - Defense Evasion: TA0005
  mitre_techniques: []
  platform:
  - windows
