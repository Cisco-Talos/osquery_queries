references: [ https://www.sentinelone.com/labs/hermetic-wiper-ukraine-under-attack/ ]
title: "Hermetic Wiper Registry Entry"
os: [ windows ]
tactics: [ execution ]
techniques: [ command-and-scripting-interpreter ]
query: SELECT key, path, name, data, DATETIME(mtime, "unixepoch", "UTC") AS last_modified FROM registry WHERE key LIKE "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\%" AND name LIKE "ImagePath" AND data LIKE regex_match(data, ".+Drivers\\[a-z]{4}\.sys$", 0) AND data NOT LIKE "dfsc.sys";
description: |
  This query detects a Registry entry associated with the HermeticWiper malware. HermeticWiper is associated with the recent events surrounding the situation in Ukraine. It is signed with a valid digital certificate entitled "Hermetica Digital Ltd" and wipes the MBP of all hard drives connected to an infected device. 
