malware_clearfake_files:
  query: 'SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, 
    DATETIME(f.atime, "unixepoch","UTC") AS last_access_time, DATETIME(f.mtime, "unixepoch", "UTC") AS 
    last_modified, DATETIME(f.ctime, "unixepoch", "UTC") AS last_status_change_time, 
    DATETIME(f.btime, "unixepoch", "UTC") AS creation_time FROM file f JOIN hash h ON 
    f.path=h.path WHERE f.path LIKE "C:\Users%\AppData\Roaming%%" AND 
    LOWER(f.filename) IN ("pythonw.exe", "MpCopyAccelerator.exe","VMWareHostOpen.exe", "python311.dll", "MpClient.dll","vmtools.dll") 
    AND f.directory LIKE regex_match(f.directory, ".*AppData\\Roaming\\((Installation Assistant .+)|([A-Za-z0-9]{6,8}))", 0);'
  interval: 86400
  snapshot: true
  description: Files associated with ClearFake malware were created. ClearFake is malware
    that masquerades as a browser update and is used to deliver information stealers such 
    as Lumma and StealC. These stealers then will exfiltrate any discovered passwords, 
    credit card data, cryptocurrency, or other valuable information from victims.
  references:
  - https://www.virustotal.com/gui/file/53c3982f452e570db6599e004d196a8a3b8399c9d484f78cdb481c2703138d47
  - https://www.rapid7.com/blog/post/2023/08/31/fake-update-utilizes-new-idat-loader-to-execute-stealc-and-lumma-infostealers/
  mitre_tactics:
  - Defense Evasion: TA0005
  mitre_techniques:
  - Dynamic-link Library Injection: T1055.001
  - Process Hollowing: T1055.012
  platform:
  - windows
