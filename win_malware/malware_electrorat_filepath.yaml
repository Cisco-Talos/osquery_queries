malware_electrorat_filepath:
  query: 'SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode,
    f.size, DATETIME(f.atime, "unixepoch","UTC") AS last_access_time, DATETIME(f.mtime,
    "unixepoch", "UTC") AS last_modified, DATETIME(f.ctime, "unixepoch", "UTC") AS
    last_status_change_time, DATETIME(f.btime, "unixepoch", "UTC") AS creation_time,
    f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.directory LIKE regex_match(f.directory,
    "\S+\\Windows\\Start\s+Menu\\Programs\\Startup$", 0) AND (f.filename="mdworker.lnk"));  '
  interval: 86400
  snapshot: true
  description: A filepath associated with ElectroRAT RAT was detected. ElectroRAT
    is written in Golang. It is capable of keylogging, taking screenshots, uploading
    files from disk, downloading files and executing commands on the infected host.
    It is known to be embedded within cryptocurrency trade management applications
    - 'Jamm' and 'eTrade' and a cryptocurrency poker app - 'DaoPoker'. ElectroRAT
    runs hidden in the background as 'mdworker'.
  references:
  - www.virustotal.com/gui/file/881be95a9632fa44deeeca23e4e19390d600ad817b2f66671d3f21453a16c7b7/detection
  mitre_tactics:
  - Collection: TA0009
  mitre_techniques:
  - Screen Capture: T1113
  platform:
  - windows
