malware_saintbot_filepath:
  description: A filepath associated with SaintBot malware was detected. SaintBot
    is a downloader that is delivered via phishing email. A seemingly benign .lnk
    file contains malicious PowerShell code that downloads the next stage of the malware.
    This component drops another Windows executable that downloads two additional
    executables. One of the final binaries disables Windows Defender. The other is
    the primary malicious component that drops a copy of Ntdll.dll and sets up persistence.
  interval: 86400
  mitre_tactics:
  - Execution: TA0002
  mitre_techniques:
  - User Execution: T1204
  platform:
  - windows
  query: SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size,
    DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch',
    'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time,
    DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT
    JOIN hash h ON f.path=h.path WHERE (f.directory LIKE 'C:\Users\%\AppData\Local\z_%'
    AND f.path LIKE regex_match(f.path, '\S+\\AppData\\Local\\z_(\S+)\\\1\.(vbs|bat)',
    0));
  references:
  - https://www.virustotal.com/gui/file/a4b705baac8bb2c0d2bc111eae9735fb8586d6d1dab050f3c89fb12589470969/detection
  snapshot: true
