ransomware_lockbit_filepath:
  query: 'SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime,
    "unixepoch","UTC") AS last_access_time, DATETIME(f.mtime, "unixepoch", "UTC")
    AS last_modified, DATETIME(f.ctime, "unixepoch", "UTC") AS last_status_change_time,
    DATETIME(f.btime, "unixepoch", "UTC") AS creation_time, f.type FROM file f LEFT
    JOIN hash h ON f.path=h.path WHERE (f.filename LIKE "%.lockbit" OR f.filename
    LIKE "%.abcd"); '
  interval: 86400
  snapshot: true
  description: LockBit is a ransomware used in targeted attacks. It attempts to use
    the VBC (Visual Basic Compiler) utility, which is a signed Microsoft executable,
    to compile and execute code on the fly. If the vbc.exe file is not found, LockBit
    downloads a copy of the legitimate executable from a malicious URL. LockBit also
    creates a ransom note called Restore-My-Files.txt in every directory. After infection,
    encrypted files are given the .lockbit or .abcd extension.
  references:
  - https://www.virustotal.com/gui/file/0f178bc093b6b9d25924a85d9a7dde64592215599733e83e3bbc6df219564335/detection
  mitre_tactics:
  - Impact: TA0040
  mitre_techniques:
  - Data Encrypted for Impact: T1486
  platform:
  - windows
