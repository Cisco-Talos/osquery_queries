ransomware_wastedlocker_filepath:
  query: 'SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime,
    "unixepoch","UTC") AS last_access_time, DATETIME(f.mtime, "unixepoch", "UTC")
    AS last_modified, DATETIME(f.ctime, "unixepoch", "UTC") AS last_status_change_time,
    DATETIME(f.btime, "unixepoch", "UTC") AS creation_time, f.type FROM file f
    LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE "%wasted_info"; '
  interval: 86400
  snapshot: true
  description: WastedLocker is ransomware commonly activated by the adversary on several different
    systems within the same targeted corporate network. It is dropped to the host through a series of
    privilege escalation and lateral movement. Encrypted files are written to disk with an extension
    consisting of the name of the target and the suffix "wasted". For each encrypted file, a ransom note
    is created using the original file name, target name extension, and the suffix "wasted_info".
  references:
  - https://www.virustotal.com/gui/file/bcdac1a2b67e2b47f8129814dca3bcf7d55404757eb09f1c3103f57da3153ec8
  mitre_tactics:
  - Impact: TA0040
  mitre_techniques:
  - Data Encrypted for Impact: T1486
  platform:
  - windows
