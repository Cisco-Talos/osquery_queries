Remcos File Artifact:
  query: SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size,
    DATETIME(f.atime, "unixepoch", "UTC") AS last_access_time,
    DATETIME(f.mtime, "unixepoch", "UTC") AS last_modified,
    DATETIME(f.ctime, "unixepoch", "UTC") AS last_status_change_time,
    DATETIME(f.btime, "unixepoch", "UTC") AS creation_time, f.type
    FROM file f LEFT JOIN hash h ON f.path=h.path
    WHERE f.directory LIKE "C:\Users\%\AppData\Roaming\%"
    AND f.filename LIKE "%.dat"
    AND f.directory=regex_match(f.directory, "C:\\Users\\[^\\]+\\AppData\\Roaming\\(rcm|log|[a-z0-9]+)\\", 0)
    AND f.filename=regex_match(f.filename, "logs?\.dat", 0)
  interval: 86400
  snapshot: true
  description: Remcos is a Remote Access Tool (RAT) with features which include keylogging,
    screen capture, webcam and microphone recording, and a lot more. An artifact with a
    path associated with Remcos is present on a host targeted by this query.
  references:
  - 34ea4cad8558fcab75631a44eae492a54e1cf9ae2f52e7d5fa712686acd06437
  - 86e96d3d22ead8f41f6a29f7bfe4b35c0d4ae5bd8da046ff0d01d9c6ea678dc2
  - 597541041b49043bd2abd482b3bf4dd233a0dbb47d5ef704ea9ee28705d2764b
  - ef74d2b8d1767667fb6817916f7d2d2c998358e07422a6af246151e0299f26aa
  mitre_tactics:
  - Credential Access: TA0006
  - Collection: TA0009
  mitre_techniques:
  - Keylogging: T1056.001
  - Screen Capture: T1113
  - Audio Capture: T1123
  - Video Capture: T1125
  platform:
  - windows
