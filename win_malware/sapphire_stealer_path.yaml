sapphirestealer_staging_file_path:
description:     A file copy to a directory associated with SapphireStealer was detected. SapphireStealer is an open-source info stealer used 
    to obtain sensitive information, such as documents and credentials, and usually part of a multistage infection process with a previous
    stage delivering the stealer via a downloader. It is often paired with other malware, such as ransomware, in an
    effort to coerce or extort more from a victim.
query: SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, "unixepoch", "UTC") AS last_access_time, DATETIME(f.mtime, "unixepoch", "UTC") AS last_modified, DATETIME(f.ctime, "unixepoch", "UTC") AS last_status_change_time, DATETIME(f.btime, "unixepoch", "UTC") AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE "\users\%\temp\%\sapphire\files" AND (f.filename LIKE "%.doc" OR f.filename LIKE "%.pdf" OR f.filename LIKE "%.txt") ORDER BY mtime DESC LIMIT 5;
interval: 86400
snapshot: true
references:
- 94107e993c42fc6e0634be29191410b50c076e129260d23351baa9f6dc7c883e
mitre_tactics:
- collection: TA0009
mitre_techniques:
- local-data-staging: T1074.001
platform:
- windows