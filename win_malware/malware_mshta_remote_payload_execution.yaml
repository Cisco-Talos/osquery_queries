MSHTA Remote Payload Execution:
  query: SELECT pid, name, cmdline FROM processes WHERE name='mshta.exe' AND cmdline LIKE '%https://%' AND
    regex_match(cmdline, 'http(s)?:\/\/[A-Za-z0-9-]+(:|\/)', 0) IS NULL AND regex_match(cmdline, 
    'http(s)?:\/\/[A-Za-z0-9-\.]+\.(test|example|invalid|localhost|local|eranet)', 0) IS NULL AND 
    regex_match(cmdline, 'OED\sEntry\sEditor', 0) IS NULL
  interval: 86400
  snapshot: true
  description: Mshta is a Windows binary that allows to execute malicious code in
    different ways, such as code hosted on external URLs, or locally hosted
    scripts. Mshta is a native windows binary that can execute VBScript,
    JScript,  and Microsoft HTML Application (HTA) files. It is capable of
    executing code  from remote URLs and from local files on disk. Mshta has
    been known to be used by a variety of threat actors like CoralRaider and malware families such
    as ModernLoader to execute malicious payloads.
  references:
  - 150dd450f343c7b1e3b2715eae3ed470c1c1fadf91f2048516315f1500a58ffa
  - 74ea6e91c00baad0b77575740eb7f0fb5ad1d05ddea8227dc1aa477e179e62df
  - 3ae459746637e6f5536f3ba4158c822031578335505a512df3c31728cac8f627
  - 88528be553f2a6f72e2ae0243ea907d5dcdcd7c8777831b4c3ab2a67128bc9b9
  - fd53383d85b39e68d817e39030aa2184764ab4de2d478b7e33afc39dd9661e96
  - e68c9aedfd080fe8e54b005482fcedb16f97caa6f7dcfb932c83b29597c6d957
  - 8c732ec41550851cc933e635708820ec9202fddc69232ca4ed625d420aec3d86
  - 1942c417f2b71068fb4c1abb31bc77426bbe3513334cdaceaff3603955830e21
  - 5ad73cf7e08b8c7bab0d96ba92607b8c9b22b61354052cf59df93b782b6e039b
  - a1f16ab97b9516e85c202ff00bd77b0b5e0e4ed29bfad28797fbbd0f25a8e0ae
  mitre_tactics:
  - Defense Evasion: TA0005
  mitre_techniques:
  - Mshta: T1218.005
  platform:
  - windows
