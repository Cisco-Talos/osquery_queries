malware_kimsukynirsoft_file:
  query: 'SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode,
    f.size, DATETIME(f.atime, "unixepoch", "UTC") AS last_access_time, DATETIME(f.mtime,
    "unixepoch", "UTC") AS last_modified, DATETIME(f.ctime, "unixepoch", "UTC") AS
    last_status_change_time,DATETIME(f.btime, "unixepoch", "UTC") AS creation_time,
    f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.path LIKE regex_match(f.path,
    "C:\\Users\\\S+\\AppData\\Roaming\\information\\a+web\.txt", 0) AND f.directory
    LIKE "C:\Users\%\AppData\Roaming\information\"); '
  interval: 86400
  snapshot: true
  description: Kimsukyii, a North Korean APT, has been known for delivering malware
    to high-value targets. The initial vector is a maldoc which downloads additional
    modules. One of the payloads is a trojanized Nirsoft WebBrowserPassView tool which
    dumps passwords into a file in %APPDATA%\information directory. This signature
    looks for the password dump file.
  references:
  - 5498c3eb2fb335aadcaf6c5d60560c5d2525997ba6af39b191f6092cb70a3aa6
  - 595be57cb6f025ec5753fbe72222e3f7c02b8cb27b438d48286375adbcf427c6
  mitre_tactics:
  - Credential Access: TA0006
  mitre_techniques:
  - Credentials From Web Browsers: T1555.003
  platform:
  - windows
