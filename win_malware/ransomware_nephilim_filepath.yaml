ransomware_nephilim_filepath:
  query: 'SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime,
    ''unixepoch'',''UTC'') AS last_access_time, DATETIME(f.mtime, ''unixepoch'', ''UTC'')
    AS last_modified, DATETIME(f.ctime, ''unixepoch'', ''UTC'') AS last_status_change_time,
    DATETIME(f.btime, ''unixepoch'', ''UTC'') AS creation_time, f.type FROM file f
    LEFT JOIN hash h ON f.path=h.path WHERE (f.path LIKE ''C:\Users\%\Desktop\%%''
    OR f.path LIKE ''C:\Users\%\Downloads\%%'' OR f.path LIKE ''C:\Users\%\Documents\%%''
    OR f.path LIKE ''C:\Documents and Settings\%\Documents\%%'') AND (f.filename LIKE
    ''%.NEFILIM'' OR f.filename LIKE ''%.NEPHILIM'' OR f.filename LIKE ''%NEPHILIN''); '
  interval: 86400
  snapshot: true
  description: A filepath associated with Nephilim was detected. Nephilim, also called
    Nefilim, is a ransomware used in targeted attacks, particularly against oil and
    energy companies. It is usually delivered via vulnerable RDP services. The encryption
    is done with a combination of AES-128 for the files and RSA-2048 to encrypt the
    AES key. After infection, encrypted files are given the .NEFILIM or .NEPHILIM
    extension.
  mitre_tactics:
  - Impact: TA0040
  mitre_techniques:
  - Data Encrypted for Impact: T1486
  platform:
  - windows
