Malware ModernLoader Registry Persistence:
  query: SELECT key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') AS last_modified
    FROM registry WHERE (key LIKE 'HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon'
    AND name='Shell' AND data LIKE regex_match(data,'mshta\s+?http(s)?:\/\/',0));
  interval: 86400
  snapshot: true
  description: The ModernLoader RAT consists of several capabilities, additional plugins
    and a variety of detection-evasion techniques. Linked attacks consists of a highly
    modular malware that can function as a standalone RAT and download and activate
    additional malicious plugins from its C2 servers. One of the modules is a modified
    variant of the SharpHide open-source utility, which attempts to create a hidden
    Registry entry. It uses the NtSetValueKey native API to create a hidden (null-terminated)
    Registry key by adding a null byte in front of the UNICODE_STRING key valuename.
    In this case, the module is used to create a Registry entry that attempts to execute
    a remote Microsoft HTA file.
  references:
  - https://www.virustotal.com/gui/file/d9c8e82c42e489ac7a484cb98fed40980d63952be9a88ff9538fc23f7d4eb27f
  mitre_tactics:
  - persistence: TA0003
  mitre_techniques: []
  platform:
  - windows
