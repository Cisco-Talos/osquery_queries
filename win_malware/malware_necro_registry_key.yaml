malware_necro_registry_key:
  query: 'SELECT key AS reg_key, path, name, data, datetime(mtime, "unixepoch", "UTC")
    as last_modified FROM registry WHERE key LIKE "%\SOFTWARE\Microsoft\Windows\CurrentVersion\Run" AND
    name LIKE "System explore"; '
  interval: 86400
  snapshot: true
  description: A registry key associated with the Necro Python bot was detected. Necro bot
    is known for targeting Linux-based and Windows operating systems and for using
    both Python scripts and executables created with pyinstaller. The newer version
    of the bot contains exploits for more than 10 different web applications and the
    SMB protocol. The infection starts with the exploitation of a vulnerability in
    one of the targeted applications or the operating systems. The bot is also capable
    of hiding its presence on the system by installing a user-mode rootkit designed
    to hide the malicious process and malicious registry entries created to ensure
    that the bot runs every time a user logs into the infected system.
  references:
  - www.virustotal.com/gui/file/c3fe8058ab46bd21d22f920960caae1f3b22a7aeba8d5315fb62461f4e989a7d/detection
  - www.virustotal.com/gui/file/bc2126c03f2242013f58b43eb91351fba15d300385252423c52a5b18ece6a54f/detection
  - www.virustotal.com/gui/file/19c25ce4302050aec3c921dd5cac546e8200a7e951d570b52fe344c421105ea8/detection
  mitre_tactics:
  - Persistence: TA0003
  mitre_techniques:
  - Modify Registry: T1112
  platform:
  - windows
