SugarGh0st RAT File:
  query: SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, 
    DATETIME(f.atime, "unixepoch", "UTC") AS last_access_time, 
    DATETIME(f.mtime, "unixepoch", "UTC") AS last_modified, 
    DATETIME(f.ctime, "unixepoch", "UTC") AS last_status_change_time, 
    DATETIME(f.btime, "unixepoch", "UTC") AS creation_time, f.type 
    FROM file f LEFT JOIN hash h ON f.path=h.path 
    WHERE f.directory LIKE "\users\%\AppData\Local\Temp" 
    AND f.filename IN ("msadocg.dll", "dplay.lib", "ctfmon.bat", "libeay32.dll", "libeay32.lib");
  interval: 86400
  snapshot: true
  description: SugarGh0st is a variant of the remote access trojan (RAT) known as Gh0st that 
    uses a modified communication protocol. The infections starts with a archive file that 
    contains a Windows shortcut (.lnk) that, when clicked, drops and opens a decoy Office 
    document or PDF while executing malicious JavaScript code in the background. This script 
    contains embedded files that are also dropped and executed, including the encrypted 
    SugarGh0st payload. SugarGh0st has various capabilities, including keylogging, backdoor, 
    shellcode execution, data collection and exfiltration, starting or terminating processes, 
    camera access and deleting Windows event logs to evade detection. 
  references:
  - ddac61f918ed87b49ef15d05873e7f52b919758aef713145f6a7d538c714fa2e
  mitre_tactics:
  - Persistence: TA0003
  - Execution: TA0002
  mitre_techniques:
  - Match Legitimate Name or Location: T1036.005
  platform:
  - windows
