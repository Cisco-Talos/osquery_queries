ransomware_prolock_filepath:
  query: 'SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime,
    "unixepoch","UTC") AS last_access_time, DATETIME(f.mtime, "unixepoch", "UTC")
    AS last_modified, DATETIME(f.ctime, "unixepoch", "UTC") AS last_status_change_time,
    DATETIME(f.btime, "unixepoch", "UTC") AS creation_time, f.type FROM file f
    LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE "C:\ProgramData\WinMgr.bmp"; '
  interval: 86400
  snapshot: true
  description: A filepath associated with Prolock was detected. Prolock is a ransomware
    that is a rebrand of the PwndLocker ransomware. Prolock targets enterprise networks
    and demands ransoms of anywhere between $175K - $660K. It attempts to encrypt
    any file that it deems is not used for the system, and a ransom note will be dropped
    in every folder that contains an encrypted file. The ransomware is kept embedded
    in a bitmap image and is extracted when an actor with full system access executes
    a script to extract the ransomware from the bitmap and execute it in memory.
  mitre_tactics:
  - Impact: TA0040
  mitre_techniques:
  - Data Encrypted for Impact: T1486
  platform:
  - windows
