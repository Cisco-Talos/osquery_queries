malware_servhelper_filepath:
  description: ServHelper is a backdoor used to install additional malware, such as
    cryptominers, infostealers and Remote Access Trojans (RAT) during attacks to financial
    and retail sectors. ServHelper's backdoor component relies on a modified Remote
    Desktop Protocol (RDP) library. Some variants of this malware drop executables
    with the png or jpg extensions in an attempt to disguise the payloads.
  interval: 86400
  mitre_tactics:
  - Execution: TA0002
  - Defense Evasion: TA0005
  mitre_techniques:
  - Masquerading: T1036
  platform:
  - windows
  query: 'SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime,
    "unixepoch", "UTC") AS last_access_time, DATETIME(f.mtime, "unixepoch", "UTC")
    AS last_modified, DATETIME(f.ctime, "unixepoch", "UTC") AS last_status_change_time,
    DATETIME(f.btime, "unixepoch", "UTC") AS creation_time, f.type FROM file f LEFT
    JOIN hash h ON f.path=h.path WHERE f.filename IN ("mediasvc.png", "mediasrv.png",
    "wupsvc.jpg") AND f.path LIKE "%:\Windows\branding\%";'
  references:
  - www.virustotal.com/gui/file/8aa55a77613e1246a7ce499a85cd52ee2d48b4f4730d62850e249d6249214abf/detection
  snapshot: true
