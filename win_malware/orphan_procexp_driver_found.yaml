orphan_procexp_driver_found:
  query: 'SELECT key, name, data, mtime
  FROM registry
  WHERE name = "ImagePath" AND
  key LIKE "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\%" AND
  mtime = (SELECT mtime FROM registry WHERE key = "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services" AND name = "ProcExp64") AND
  NOT EXISTS (SELECT key FROM registry WHERE key LIKE "HKEY_USERS\%\SOFTWARE\Sysinternals\Process Explorer");'
  interval: 86400
  snapshot: true
  description: An orphan Process Explorer driver was found on the system. Process Explorer is a legitimate Windows utility used for gathering information, and manipulating processes. It comes with a driver, procexp.sys, that can optionally be installed in order to access protected processes. A Threat Actor can abuse this driver by manually installing where it can then be used to uninstall EDR and Antivirus software in order to prevent detection.
  references:
  - https://news.sophos.com/en-us/2023/04/19/aukill-edr-killer-malware-abuses-process-explorer-driver/
  mitre_tactics:
  - Defense Evasion: TA0005
  mitre_techniques:
  -   Disable or Modify Tools : T1562.001
  platform:
  - windows
