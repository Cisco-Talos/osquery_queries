ransomware_conti_filepath:
  query: 'SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime,
    ''unixepoch'',''UTC'') AS last_access_time, DATETIME(f.mtime, ''unixepoch'', ''UTC'')
    AS last_modified, DATETIME(f.ctime, ''unixepoch'', ''UTC'') AS last_status_change_time,
    DATETIME(f.btime, ''unixepoch'', ''UTC'') AS creation_time, f.type FROM file f
    LEFT JOIN hash h ON f.path=h.path WHERE (f.path LIKE "%CONTI_README.txt"
    OR f.path LIKE "%CONTI.txt" OR f.path LIKE "%R3ADM3.txt") AND f.path NOT
    LIKE ''%\Recent'' AND f.path NOT LIKE ''%backup%''; '
  interval: 86400
  snapshot: true
  description: Conti Ransomware is known for breaching the networks of businesses
    and government agencies, moving laterally via SMB (Server Message Block), encrypting
    files and exfiltrating victim's data. The first variants use the word Conti on
    the ransom note and on the file extension appended to the encrypted files. More
    recent variants use a random file extension and create ransom notes called "readme.txt".
    To encrypt the data, Conti uses a different AES-256 encryption key per file with
    a hardcoded RAS-4096 public encryption key that is unique for each victim.
  references:
  - https://www.virustotal.com/gui/file/1b8081bae0e493d098b8756b1e7c4b19715a78946cf227f2c27f9311e6718420/behavior
  - https://www.virustotal.com/gui/file/d3c75c5bc4ae087d547bd722bd84478ee6baf8c3355b930f26cc19777cd39d4c/behavior
  - https://www.virustotal.com/gui/file/f20ed03ba228b36064517c1e5fff9ae40d957451a5c6d9a48f9bbe2c3dd881b7/behavior
  mitre_tactics:
  - Execution: TA0002
  - Impact: TA0040
  mitre_techniques:
  - Data Encrypted for Impact: T1486
  platform:
  - windows
