ransomware_hansom:
  query: 'SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, "unixepoch", "UTC") AS last_access_time, DATETIME(f.mtime, "unixepoch", "UTC") as last_modified, DATETIME(f.ctime, "unixepoch", "UTC") as last_status_change_time, DATETIME(f.btime, "unixepoch", "UTC") as creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE "%HANSOM_README.txt"; '
  interval: 86400
  snapshot: true
  description: Hansom is a ransomware plugin used by the CRAT malware family. Instead of encrypting targeted files, Hansom will generate random passwords and use them to protect RAR archives containing the files held for ransom. The passswords are archived themselves and encrypted with a public key.
  references:
  - https://www.virustotal.com/gui/file/cb141c743ac41784501e2e84ccd9969aade82b296df077daff3c0734bb26c837
  mitre_tactics:
  - Impact: TA0040
  mitre_techniques:
  - Data Encrypted for Impact: T1486
  platform:
  - windows
