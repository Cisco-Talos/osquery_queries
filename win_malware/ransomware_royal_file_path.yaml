ransomware_royal_group_file_path:
  query: SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid,
    f.mode, f.size, DATETIME(f.atime, "unixepoch", "UTC") AS last_access_time,
    DATETIME(f.mtime, "unixepoch", "UTC") AS last_modified,
    DATETIME(f.ctime, "unixepoch", "UTC") AS last_status_change_time,
    DATETIME(f.btime, "unixepoch", "UTC") AS creation_time, f.type
    FROM file f LEFT JOIN hash h ON f.path=h.path
    WHERE (f.directory LIKE "C:\Users\%%" AND f.filename
    LIKE regex_match(f.filename, "\S+\.royal(_w)?$", 0))
    ORDER BY mtime DESC LIMIT 5; 
  interval: 86400
  snapshot: true
  description: Royal Ransomware is a group of malware operators
  believed to consist of former members of the Conti ransomware group.
  They are known to target critical infrastructure such as healthcare 
  and telecommunications. When encrypting files on a device, the 
  malware will append the ".royal" or "royal_w" to the encrypted file.  
  references:
  - 5fda381a9884f7be2d57b8a290f389578a9d2f63e2ecb98bd773248a7eb99fa2
  mitre_tactics:
  - impact: TA0040
  mitre_techniques:
  - data-encrypted-for-impact: T1486
  platform:
  - windows
