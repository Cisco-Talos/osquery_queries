malware_betabot_detected:
  description: This query is applicable to Windows. It detects hosts infected by Betabot.
    Betabot (aka Neurevt) is a trojan with capabilities such as information stealing,
    cryptocurrency mining and remote access. The information stealing capabilities
    are known to use form grabbing in browsers as well as harvesting credentials from
    programs such as FTP and email clients. Additionally, this malware family is known
    to spread via USB devices that are exposed to an infected machine.
  interval: 86400
  mitre_tactics:
  - Persistence: TA0003
  mitre_techniques:
  - Modify Registry: T1112
  platform:
  - windows
  query: SELECT key AS reg_key, path, name, type, data, datetime(mtime, 'unixepoch',
    'UTC') AS last_modified FROM registry WHERE key LIKE 'HKEY_USERS\%\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce'
    AND data LIKE regex_match(data, '^[A-Z]:\\ProgramData\\Google Updater [0-9\.]+\\[a-z0-9]+\.exe$',
    0);
  references:
  - www.virustotal.com/gui/file/86aab09b278fe8e538d8cecd28f2d7a32fe413724d5ee52e2815a3267a988595/detection
  snapshot: true
