malware_eccentricbandwagon_filepath:
  query: 'SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode,
    f.size, DATETIME(f.atime, "unixepoch", "UTC") AS last_access_time, DATETIME(f.mtime,
    "unixepoch", "UTC") AS last_modified, DATETIME(f.ctime, "unixepoch", "UTC") AS
    last_status_change_time, DATETIME(f.btime, "unixepoch", "UTC") AS creation_time,
    f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE ((f.directory LIKE
    "C:\Users\%\AppData\Local\Temp\Downloads" AND f.filename LIKE regex_match(f.filename,
    "tmp_\S+_(0[1-9]|1[0-2])(0[1-9]|[1-2]\d|3[0-1])_(2[0-3]|[01]\d)[0-5]\d[0-5]\d$",
    0)) OR (f.directory LIKE "C:\Users\%\AppData\Local\Temp\GoogleChrome" AND f.filename
    LIKE regex_match(f.filename, "chromeupdater_ps_\d{4}(0[1-9]|1[0-2])(0[1-9]|[1-2]\d|3[0-1])_(2[0-3]|[01]\d)[0-5]\d[0-5]\d_\d{3}_\d{1,4}$",
    0)) OR (f.directory LIKE "C:\Users\%\AppData\Local\Temp\TrendMicroUpdates" AND
    f.filename LIKE regex_match(f.filename, "update_(0[1-9]|1[0-2])(0[1-9]|[1-2]\d|3[0-1])_(2[0-3]|[01]\d)[0-5]\d[0-5]\d$",
    0))); '
  interval: 86400
  snapshot: true
  description: A filepath associated with EccentricBandwagon RAT was detected. This
    family of malware is used as a reconnaissance tool and some variants have keylogging
    and screen capture functionality.
  references:
  - https://www.virustotal.com/gui/file/c6930e298bba86c01d0fe2c8262c46b4fce97c6c5037a193904cfc634246fbec/detection
  - https://www.virustotal.com/gui/file/9ea5aa00e0a738b74066c61b1d35331170a9e0a84df1cc6cef58fd46a8ec5a2e/detection
  - https://www.virustotal.com/gui/file/efd470cfa90b918e5d558e5c8c3821343af06eedfd484dfeb20c4605f9bdc30e/detection
  mitre_tactics:
  - Execution: TA0002
  - Credential Access: TA0006
  - Collection: TA0009
  mitre_techniques:
  - Data Staged: T1074
  - Input Capture: T1056
  - Screen Capture: T1113
  platform:
  - windows
