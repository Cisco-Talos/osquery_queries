malware_scartrojan_filepath:
  query: SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size,
    DATETIME(f.atime, "unixepoch","UTC") AS last_access_time, DATETIME(f.mtime, "unixepoch",
    "UTC") AS last_modified, DATETIME(f.ctime, "unixepoch", "UTC") AS last_status_change_time,
    DATETIME(f.btime, "unixepoch", "UTC") AS creation_time FROM file f JOIN hash h
    ON f.path=h.path WHERE (f.path LIKE "C:\Users\%\AppData\Roaming\%%\MsdUpdate.exe"
    OR f.path LIKE "C:\Users\%\AppData\Roaming\%%\DysonPart.exe" OR f.path LIKE "C:\Users\%\AppData\Roaming\%%\SmartMega.exe")
    AND f.directory LIKE regex_match(f.directory, ".*AppData\\Roaming\\(SmartMega|MSDUpdate|DysonPart)",0)
    AND f.filename LIKE regex_match(f.filename,"(MsdUpdate|DysonPart|SmartMega)\.exe",0);
  interval: 86400
  snapshot: true
  description: A filepath associated with SCAR Trojan was detected. SCAR Trojan is
    a dropper malware that is part of a botnet and calls out to command and control
    (C2) servers to download additional paylaods. This Trojan is associated with APT33
    which use destructive techniques such as disk wiping.
  platform:
  - windows
