ransomware_ragnarlocker_filepath:
  query: 'SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime,
    ''unixepoch'',''UTC'') AS last_access_time, DATETIME(f.mtime, ''unixepoch'', ''UTC'')
    AS last_modified, DATETIME(f.ctime, ''unixepoch'', ''UTC'') AS last_status_change_time,
    DATETIME(f.btime, ''unixepoch'', ''UTC'') AS creation_time, f.type FROM file f
    LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE ''RGNR_%'' OR f.path LIKE
    ''%.ragnar_%''; '
  interval: 86400
  snapshot: true
  description: A filepath associated with Ragnar Locker was detected. Ragnar Locker
    is ransomware hidden within a virtual machine to avoid endpoint detection. An
    MSI package deploys an old version of VirtualBox responsible for starting the
    virtual machine in a headless mode that is hidden from the user.
  mitre_tactics:
  - Impact: TA0040
  mitre_techniques:
  - Data Encrypted for Impact: T1486
  platform:
  - windows
