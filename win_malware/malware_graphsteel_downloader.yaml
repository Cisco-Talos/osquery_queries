GraphSteel Downloader:
  query: 'SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, "unixepoch", "UTC") AS last_access_time, DATETIME(f.mtime, "unixepoch", "UTC") AS last_modified, DATETIME(f.ctime, "unixepoch", "UTC") AS last_status_change_time, DATETIME(f.btime, "unixepoch", "UTC") AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.directory LIKE "C:\Users\%\AppData\Local\Temp\" AND LOWER(f.filename)="base-update.exe") OR (f.directory LIKE "C:\Users\%\Java-sdk\" AND LOWER(f.filename) IN ("java-sdk.exe", "microsoft-cortana.exe", "oracle-java.exe"));'
  interval: 86400
  snapshot: true
  description: |
    GraphSteel is an implant responsible for preliminary reconnaissance
    and credential harvesting on infected endpoints. It communicates with a C2 server
    and executes a variety of commands during runtime for the aforementioned behavior.
    This malware family, along with the similar GrimPlant implant, are both downloaded
    first via golang binaries.
  references:
  - www.virustotal.com/gui/file/8ffe7f2eeb0cbfbe158b77bbff3e0055d2ef7138f481b4fac8ade6bfb9b2b0a1/detection
  mitre_tactics:
  - credential-access: TA0006
  techniques:
  - credentials-from-password-stores: T1555
  platform:
  - windows
