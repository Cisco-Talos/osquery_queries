malware_kimsukykeylogger_file:
  query: 'SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode,
    f.size, DATETIME(f.atime, "unixepoch", "UTC") AS last_access_time, DATETIME(f.mtime,
    "unixepoch", "UTC") AS last_modified, DATETIME(f.ctime, "unixepoch", "UTC") AS
    last_status_change_time,DATETIME(f.btime, "unixepoch", "UTC") AS creation_time,
    f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.path LIKE "C:\Users\%\AppData\Roaming\Microsoft\pubs\desktop.ini"); '
  interval: 86400
  snapshot: true
  description: Kimsuky, a North Korean APT, has been known for delivering malware
    to high-value targets. Their keylogger malware periodically records specific keystrokes
    from the victim into a log file. This signature detects the existence of that
    log file.
  references:
  - https://www.virustotal.com/gui/file/dddc57299857e6ecb2b80cbab2ae6f1978e89c4bfe664c7607129b0fc8db8b1f
  mitre_tactics:
  - Credential Access: TA0006
  mitre_techniques:
  - Keylogging: T1056.001
  platform:
  - windows
