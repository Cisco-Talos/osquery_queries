Yashma Ransomware Registry Persistence:
  query: SELECT key, path, name, data, DATETIME(mtime, "unixepoch", "UTC") AS last_modified 
    FROM registry WHERE (key LIKE "HKEY_USERS\S-%\Software\Microsoft\Windows\CurrentVersion\Run"
    AND name="UpdateTask" AND data LIKE "%.exe") OR key LIKE "HKEY_USERS\S-%\Software\oAnWieozQPsRK7Bj83r4";
  interval: 86400
  snapshot: true
  description: A Registry key associated with the Yashma ransomware was created on the 
    system. Yashma ransomware is a variant of Chaos ransomware and it's known 
    for targeting multiple geographic areas and for mimicking WannaCry 
    characteristics. Unlike other ransomware families, the ransom note is not 
    embedded in the binary but downloaded from a GitHub repository. To gain 
    persistence, some Yashma variants add the file path of the malicious 
    executable to the Run Registry key. Other variants create a Registry key 
    with a unique string to detect whether it has already infected a system. 
  references:
  - 3ea6df18492d21811421659c4cf9b88e64c316f2bef8a19766b0c79012476cac
  mitre_tactics:
  - Persistance: TA0003
  mitre_techniques:
  - Registry Run Keys / Startup Folder: T1060
  platform:
  - windows
