{
    "platform": "linux",
    "queries": {
        "malware_xanthe_filepath": {
            "query": "SELECT path, directory, filename, uid, gid, mode, size, DATETIME(atime, 'unixepoch','UTC') AS last_access_time, DATETIME(mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(btime, 'unixepoch', 'UTC') AS creation_time FROM file  WHERE (path LIKE '/opt/logger%%' OR path LIKE '/opt/autoupdater%%' OR path LIKE '/opt/system%%' OR path LIKE '/usr/local/lib/libprocesshider.so'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with Xanthe was detected. Xanthe is a multi-modular botnet that drops a payload to mine Monero cryptocurrency and employs various methods to spread across networks, mainly harvesting client-side certificates to gain access to known hosts using ssh or taking advantage of systems with an incorrectly configured Docker API.\n",
            "platform": [
                "linux"
            ]
        },
        "malware_xanthe_crontab": {
            "query": "SELECT minute, hour, day_of_month, month, day_of_week, command, path FROM crontab WHERE command LIKE 'curl%fczyo%http%' OR command LIKE 'curl%xanthe%http%' OR command LIKE 'curl%currenthost%http%' OR command LIKE 'curl%filegetgo%http%' OR command LIKE 'curl%hostcheck%http%' OR command LIKE 'curl%qi/1.1%http%' OR command LIKE 'curl%goteeeem%http%' OR command LIKE 'curl%shell-success%http%' OR command LIKE 'curl%xesacheck-running%http%' OR command LIKE 'curl%wemusthavegotkilled%http%'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A cron job associated with Xanthe was detected. Xanthe is a multi-modular botnet that drops a payload to mine Monero cryptocurrency and employs various methods to spread across networks, mainly harvesting client-side certificates to gain access to known hosts using ssh or taking advantage of systems with an incorrectly configured Docker API.\n",
            "platform": [
                "linux"
            ]
        },
        "XMRig Curl Command Line": {
            "query": "SELECT p.name, p.pid, DATETIME(p.start_time, 'unixepoch', 'UTC') AS start_time, p.cmdline FROM processes p WHERE name LIKE 'curl' AND p.cmdline LIKE 'curl%http%xmrig%';",
            "interval": 86400,
            "snapshot": "True",
            "description": "XMRig is an open source, cross platform cryptocurrency miner. Although not necessarily malicious, miners use a large amount of CPU and/or GPU resources to mine cryptocurrency, which may negatively impact system performance and/or availability. Recent samples are being deployed by CVE-2021-44228, a vulnerability in Log4J, a library that is part of the Apache Logging Services. ",
            "platform": [
                "linux"
            ]
        },
        "CyclopsBlink Path": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch', 'UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE ((f.path LIKE '%pending%' AND (f.filename LIKE regex_match(f.filename, '[0-9]{10,19}_-?[0-9]{6,10}_-?[0-9]{3,10}_p1', 0) OR f.filename LIKE regex_match(f.filename, 'test(_-?[0-9]{1,10}){6}', 0) OR f.filename LIKE regex_match(f.filename, 'WGUpgrade-dl\\.new', 0) OR f.filename LIKE regex_match(f.filename, 'install_upgraded', 0))) OR (f.directory LIKE '/etc/wg' AND (f.filename LIKE regex_match(f.filename, 'configd-hash\\.xml', 0) OR f.filename LIKE regex_match(f.filename, 'config\\.xml',0))) OR (f.directory LIKE '/var/tmp' AND f.filename LIKE 'a.tmp') OR (f.filename LIKE 'rootfs_cfg' OR f.filename LIKE '214688dsf46'));",
            "interval": 86400,
            "snapshot": "True",
            "description": "This query detects a file path used by the CyclopsBlink botnet. CyclopsBlink is a large scale botnet compiled for PPC. It has modules to download/upload files, extract device information, and update itself. It is associated with recent events surrounding Ukraine.",
            "platform": [
                "linux"
            ]
        }
    }
}
