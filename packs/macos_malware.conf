{
    "platform": "macos",
    "queries": {
        "malware_thiefquest_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time  FROM file f JOIN hash h ON f.path=h.path  WHERE (f.path LIKE '/Library/mixednkey/toolroomd' OR f.path LIKE '/Library/AppQuest/com.apple.questd' OR f.path LIKE '/Library/LaunchDaemons/com.apple.questd.plist' OR f.path LIKE '/Users/%/Library/AppQuest/com.apple.questd' OR f.path LIKE '/Users/%/Library/LaunchAgents/com.apple.questd.plist'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with ThiefQuest Ransomware was detected. ThiefQuest is a ransomware that has keylogging and remote command execution capabilities.\n",
            "platform": [
                "macos"
            ]
        },
        "malware_dacls_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.path LIKE '%/Library/.mina' OR f.path LIKE '%/Library/LaunchAgents/com.aex-loop.agent.plist' OR f.path LIKE '%/Library/LaunchDaemons/com.aex-loop.agent.plist'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with the Dacls RAT (Remote Access Trojan) was detected. Dacls samples contain strings that link them to the Lazarus cybercriminal group, that also created Dacls RAT variants for Windows and Linux. To achieve persistence, Dacls creates a plist (property list) file inside /Library/LaunchAgents or /Library/LaunchDaemons/ to run a hidden file on startup. Dacls is also known for its use of plugins to perform different functions, such as scanning directories, downloading files and sending collected logs to its command and control. \n",
            "platform": [
                "macos"
            ]
        }
    }
}
