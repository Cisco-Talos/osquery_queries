{
    "platform": "windows",
    "queries": {
        "malware_bisonal_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size,  DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time,  DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified,  DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time,  DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE 'C:\\Windows\\Tasks\\conime.exe'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A file path associated with Bisonal was created. Bisonal is a Remote Access Trojan (RAT) that usually targets government, military or other public and private organizations in South Korea, Japan and Russia. The primary infection vector is via spear phishing campaigns with malicious documents attached. Bisonal is also known for using Dynamic DNS for its Command and Control servers.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_bisonal_registry": {
            "query": "SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') AS last_modified FROM registry  WHERE (key LIKE 'HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432NODE\\MICROSOFT\\WINDOWS NT\\CURRENTVERSION\\WINLOGON'  OR key LIKE 'HKEY_USERS\\%\\Software\\Microsoft\\Windows\\CurrentVersion\\Run' OR key LIKE 'HKEY_LOCAL_MACHINE\\SYSTEM\\CONTROLSET001\\SERVICES\\FASTUSERSWITCHINGCOMPATIBILITY\\PARAMETERS') AND (name IN ('mismyou', 'Microsofttool', 'workhelper') OR data LIKE 'netcat27.dll' OR data LIKE '%temp\\pvcu.dll%' OR data LIKE '%Windows\\Tasks\\conime.exe'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A registry key associated with Bisonal was created. Bisonal is a Remote Access Trojan (RAT) that usually targets government, military or other public and private organizations in South Korea, Japan and Russia. The primary infection vector is via spear phishing campaigns with malicious documents attached. Bisonal is also known for using Dynamic DNS for its Command and Control servers.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_azorult_registry": {
            "query": "SELECT key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') as last_modified FROM registry WHERE key LIKE '%SYSTEM%SERVICES%LOCALNETSERVICE%' AND name LIKE '%ImagePath';",
            "interval": 86400,
            "snapshot": true,
            "description": "This query detects the presence of a registry key/dataname combination known to be created during Azorult execution. Azorult is an information stealer capable of exfiltrating sensitive user data such as files, passwords, and cryptocurrency wallet keys.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_windex_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.path LIKE '%\\AppData\\Roaming\\Microsoft\\Repairs\\sha.dll' OR f.path LIKE '%\\AppData\\Roaming\\Microsoft\\Caches\\Files\\usd.dll' OR f.path LIKE '%\\AppData\\Roaming\\Microsoft\\Identities\\Administrator\\arc.dll' OR f.path LIKE '%\\AppData\\Roaming\\Microsoft\\Common\\Shared.dll' OR f.path LIKE '%\\AppData\\Roaming\\Microsoft\\Shared\\Modules\\fil.dll' OR f.path LIKE '%\\AppData\\Roaming\\Microsoft\\Windows\\Addins\\att.dll' OR f.path LIKE '%\\AppData\\Roaming\\Microsoft\\Defender\\launch.exe' OR f.path LIKE '%\\AppData\\Roaming\\Microsoft\\Messenger\\Extension\\WdExt.exe' OR f.path LIKE '%\\Windows\\SysWOW64\\mscaps.exe'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "\"A filepath associated with Windex was detected. Windex is malware found hosted on a North Korean news site and used in a watering hole attack. Various file artifacts created during runtime are dropped to the Microsoft subdirectory within APPDATA\"\n",
            "platform": [
                "windows"
            ]
        },
        "malware_dcrat_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch', 'UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE '%DCRatBuild%' OR f.path LIKE '%\\Temp\\dclib%'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with DCRat was created. DCRat is a Remote Access Trojan (RAT) capable of stealing credentials.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_ap0calypserat_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE '%Windows\\apocalyps32.exe'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with Ap0calypseRAT was created. Ap0calypseRAT is a Remote Access Trojan (RAT) capable of arbitrary command execution, keylogging, remote desktop access, and file exfiltration.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_raccoon_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND (object_name LIKE 'rc_%'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with Raccoon info stealer was created. Raccoon is a stealer that collects passwords, cookies, autofill from all popular browsers (including FireFox x64), CC data, system information, and almost all existing desktop wallets of cryptocurrencies\n",
            "platform": [
                "windows"
            ]
        },
        "malware_cryptbot_registry": {
            "query": "SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') AS last_modified FROM registry WHERE (data LIKE '%ProgramData\\Cryptbot\\margin.exe%'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A registry key associated with Cryptbot was created. Cryptbot is a trojan designed to steal passwords, cryptowallets, browser credentials, and other information.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_proyectorat_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.path LIKE '%\\AppData\\Roaming\\LocalAdmin\\Conf.ini' OR f.path LIKE '%\\AppData\\Roaming\\LocalOffice\\Conf.ini' OR f.path LIKE '%\\AppData\\Roaming\\Office\\Conf.ini' OR f.path LIKE '%\\AppData\\Roaming\\AgentLog\\Conf.ini' OR f.path LIKE '%\\AppData\\Roaming\\AgentLogs\\Conf.ini' OR f.path LIKE '%\\AppData\\Roaming\\Sys'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with Proyecto RAT was detected. Proyecto RAT is a remote administration tool delivered via emails with malicious RTF files attached. This threat is capable of recording keystrokes, downloading additional files, executing commands, using the webcam and more. The latest campaign uses a disposable email service called YOPmail as its command and control, and targets financial institutions and government agencies in South America.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_ryuk_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE '%RyukReadMe.txt' OR f.path LIKE '%RyukReadMe.html' OR f.path LIKE '%RyukReadMe.lnk'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with Ryuk was detected. Ryuk is a ransomware known for targeting large organizations and asking for rather large ransom payments to recover the encrypted files. The infection has been associated with emails that contain malicious attachments that first deliver Emotet, which is used to deliver modular payloads such as Ryuk. \n",
            "platform": [
                "windows"
            ]
        },
        "malware_sality_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND object_name LIKE '%.exeM_%_'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with Sality was created. Sality is a polymorphic file infector and one of the most resilient malware in the threat landscape. Once a Sality sample bypasses perimeter security, its goal is to download and execute additional malware components. To avoid infecting the same process multiple times, Sality creates a mutex with the process name and the decimal representation of the process ID.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_proyectorat_registry": {
            "query": "SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') AS last_modified FROM registry WHERE (key LIKE '%\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\RUN' OR key LIKE '%\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\RUNONCE') AND data LIKE '%\\AppData\\Roaming\\LocalAdmin\\%.exe' OR data LIKE '%\\AppData\\Roaming\\LocalOffice\\%.exe' OR data LIKE '%\\AppData\\Roaming\\Office\\%.exe' OR data LIKE '%\\AppData\\Roaming\\AgentLogs\\%.exe' OR data LIKE '%\\AppData\\Roaming\\AgentLog\\%.exe'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "Registry keys associated with Proyecto RAT were created. Proyecto RAT is a remote administration tool delivered via emails with malicious RTF files attached. This threat is capable of recording keystrokes, downloading additional files, executing commands, using the webcam and more. The latest campaign uses a disposable email service called YOPmail as its command and control, and targets financial institutions and government agencies in South America.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_betabot_registry": {
            "query": "SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') AS last_modified FROM registry WHERE (key LIKE '%\\SOFTWARE\\WIN7ZIP' AND name LIKE 'Uuid'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A registry key associated with BetaBot was created. BetaBot, also known as Neurevt, is a botnet with a large number of capabilities, such as downloading additional malware, stealing banking data, DDoS attacks and website sniffing. Modules for a rootkit and a crypto-currency miner were added in recent years. It also attempts to disable security-related applications and even blocks some code injection techniques and other malicious activity to prevent other malware from running on the system.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_ryuk_registry": {
            "query": "SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') AS last_modified FROM registry WHERE key LIKE '%\\Software\\Microsoft\\Windows\\CurrentVersion\\Run' AND name LIKE 'svchos'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A registry key associated with Ryuk was created. Ryuk is a ransomware known for targeting large organizations and asking for rather large ransom payments to recover the encrypted files. The infection has been associated with emails that contain malicious attachments that first deliver Emotet, which is used to deliver modular payloads such as Ryuk. To achieve persistence, Ryuk adds a registry key to execute itself at every login.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_netwirerat_registry": {
            "query": "SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') AS last_modified FROM registry WHERE key LIKE '%SOFTWARE\\NETWIRE'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A registry key associated with NetWire RAT was created. NetWire is a publicly available, multiplatform remote administration tool (RAT) that has been used by criminal and APT groups. Although it includes remote control capabilities, its functionality seems focused on password stealing and keylogging. Newer variants of NetWire are capable of scraping credit card data and reading data from connected USB devices.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_glupteba_registry": {
            "query": "SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') AS last_modified FROM registry  WHERE key LIKE 'HKEY_USERS\\%\\SOFTWARE\\MICROSOFT\\TESTAPP'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A registry key associated with Glupteba was created. Glupteba is malware providing easy botnet management. It is capable of stealing credentials, collecting system information, and adding the infected machine to it's botnet.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_vilsel_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND object_name LIKE 'Pro3'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with Vilsel was created. Vilsel is a trojan that is capable of downloading additional malware, and modifying system configurations. \n",
            "platform": [
                "windows"
            ]
        },
        "malware_smominru_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND object_name LIKE 'Windows 10 Pro02'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with Smominru was created. Smominru (also known as MyKings) is a botnet that uses a trojan with a modular design for spreading. Based on the modules installed, Smominru is capable of lateral movement exploiting known vulnerabilities such as EternalBlue, brute-forcing services such as RDP, stealing credentials, and mining cryptocurrency.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_revengerat_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND object_name LIKE '%RV_MUTEX%'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with RevengeRAT was created. RevengeRAT is a Remote Access Trojan (RAT) capable of stealing credentials, executing commands, manipulating system configurations, and interacting with peripherals. \n",
            "platform": [
                "windows"
            ]
        },
        "malware_plasmarat_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND (object_name LIKE '4919245' OR object_name LIKE '3818273' OR object_name LIKE '83729184726481' OR object_name LIKE '48727194728194'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with PlasmaRAT was created. PlasmaRAT is a Remote Access Trojan (RAT) that has many capabilities including mining, denial of service, remote desktop access, and keylogging. PlasmaRAT's sourcecode is freely available online and has been seen used by threat actors such as APT33.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_obliquerat_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND object_name LIKE 'Oblique'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with ObliqueRAT was created. ObliqueRAT is a Remote Access Trojan (RAT) that has many capabilities including arbitrary command execution, file exfiltration, and sandbox detection. The method of infection is malicious Microsoft Office documents containing macros.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_medusa_registry": {
            "query": "SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') AS last_modified FROM registry  WHERE key LIKE 'HKEY_USERS\\%\\Software\\MEDUSA'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A registry key associated with MedusaLocker was created. MedusaLocker is ransomware that encrypts files with the AES crypto algorithm. Persistence is established by creating a scheduled task to execute a copy of itself from the AppData Roaming folder. A notable feature of MedusaLocker is that it manipulates the registry to allow it to reach mapped network drives for encryption.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_wastedlocker_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch', 'UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE '%wasted_info'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "WastedLocker is ransomware commonly activated by the adversary on several different systems within the same targeted corporate network. It is dropped to the host through a series of privilege escalation and lateral movement. Encrypted files are written to disk with an extension consisting of the name of the target and the wasted suffix. For each encrypted file, a ransom note is created using the original file name, target name extension, and the wasted_info suffix. ",
            "platform": [
                "windows"
            ]
        },
        "ransomware_wastedlocker_initial_compromise": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch', 'UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.path LIKE 'C:\\Users\\%\\AppData\\%\\Temp\\Temp%Chrome%Update%\\%.js') AND f.path LIKE regex_match(f.path,'C:\\\\Users\\\\[^\\\\]+\\\\AppData\\\\Temp\\\\Temp\\d+_Chrome\\.Update\\.[^\\\\]+\\.zip\\\\Chrome\\.Update\\.[^\\\\]+\\.js$',0); ",
            "interval": 86400,
            "snapshot": true,
            "description": "WastedLocker is ransomware commonly activated by the adversary on several different systems within the same targeted corporate network. It is dropped to the host through a series of privilege escalation and lateral movement. The initial compromise involves a fake Google Chrome web browser update delivered as a drive-by download from a compromised website.",
            "platform": [
                "windows"
            ]
        },
        "malware_frenchy_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND object_name LIKE 'frenchy_shellcode_%'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with Frenchy was created. Frenchy is a shellcode tool leveraged by many malware families including Emotet and AgentTesla. The tool facilitates evading detection while launching malicious processes. \n",
            "platform": [
                "windows"
            ]
        },
        "malware_blackrat_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND object_name LIKE 'qSILlzCwXBSrQ1Vb72'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with BlackRAT was created. BlackRAT is a remote access trojan (RAT) that is capable of downloading additional malware, executing commands, and exfiltration of information from the infected machine.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_ap0calypserat_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND object_name LIKE 'apocalyps32'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with Ap0calypseRAT was created. Ap0calypseRAT is a Remote Access Trojan (RAT) that has many capabilities including arbitrary command execution, keylogging, remote desktop access, and file exfiltration. The primary infection vector of Ap0calypseRAT is unknown. This RAT has shown up periodically on underground forums, and has been seen as an additional payload dropped by other malware families.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_chernolocker_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE '%(.CHERNOLOCKER)' OR f.path LIKE '%(.chernolocker)' OR f.path LIKE '%(.filelocker@protonmail.ch)' OR f.path LIKE '%.(.filelocker@protonmail.ch)'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with Chernolocker was detected. ChernoLocker is ransomware using AES-256 to encrypt a victim's files and requests Bitcoin for the ransom payment. The attacker's e-mail address and choice of encrypted file extension has changed over time with each variant.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_gandcrab_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND (object_name LIKE 'pc_group=%ransom_id%'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with Gandcrab was created. Gandcrab is a ransomware variant first observed in January 2018. It has been delivered with email spam through the Necurs botnet, RIG Exploit Kit, GrandSoft Exploit Kit, and as part of the EITest Campaign.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_limerat_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND (object_name LIKE 'C9C1EE6A969F' OR object_name LIKE '6691A1ED40AE' OR object_name LIKE 'I0xpbWVSQVQ=' OR object_name LIKE '_Lime_Worm_'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with LimeRAT was created. LimeRAT is a .NET Remote Administration Tool for Windows (RAT) with many plugins. Existing plugins provide the ability to mine the Monero (XMR) cryptocurrency, perform a Distributed Denial of Service (DDoS) attack, encrypt files on all drives including USB, steal passwords, replace cryptocurrency addresses with the attackers and more.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_quasarrat_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND (object_name LIKE 'QSR_MUTEX_%' OR object_name LIKE '123AKs82kA,ylAo2kAlUS2kYkala!' OR object_name LIKE 'MUTEX___________________'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with QuasarRAT was created. QuasarRAT is an open source 'Remote Administration Tool' that is often used maliciously.  Its capabilities include keylogging, remote shell, file and task management, registry editing, encoded communication, download/upload and execution. The code is available and may be incorporated into other tools.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_socelars_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND (object_name LIKE 'yesterday'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with Socelars was created. Socelars is a trojan that is disguised as a PDF reader. Socelars attempts to steal Facebook and Amazon session cookies, as well as any personal data from Facebook's Ads Manager.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_webmonitorrat_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND object_name LIKE 'revcode-persistence-module'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with WebMonitor RAT was created. WebMonitor RAT is a Remote Access Trojan (RAT). While commonly tagged by anti-virus vendors with generic detection, WebMonitor has been present since 2017. Malicious actors are limited to the developers' Command-and-Control-as-a-Service or VPN option when using WebMonitor RAT to procure sensitive information or perform tasks on the compromised host.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_poetrat_registry": {
            "query": "SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') AS last_modified FROM registry WHERE key LIKE '%\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\RUN' AND data LIKE '%\\Python37\\pythonw.exe%\\Python37\\launcher.py%'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "Registry keys associated with PoetRAT were created. PoetRAT is a Python-based remote administration tool delivered via emails with malicious DOC files attached. This threat is capable of recording keystrokes, downloading additional files, executing commands, using the webcam and more.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_poetrat_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.path LIKE '%\\Python37\\smile_funs.py' OR f.path LIKE '%\\Python37\\frown.py' OR f.path LIKE '%\\Python37\\smile.py' OR f.path LIKE %Users\\Public\\Milan%\\config.lua OR f.path LIKE %Users\\Public\\Mew\\%pythonw.exe); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with PoetRAT was detected. PoetRAT is a Python-based remote administration tool delivered via emails with malicious DOC files attached. This threat is capable of recording keystrokes, downloading additional files, executing commands, using the webcam and more.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_astaroth_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time FROM file f JOIN hash h ON f.path=h.path WHERE f.path LIKE 'C:\\Users\\%\\AppData\\Roaming\\%%\\sqlite3.dll' AND f.directory LIKE regex_match(f.directory, '.*AppData\\\\Roaming\\\\[A-Z]{3}[0-9]{11}[A-Z]', 0) AND f.filename LIKE 'sqlite3.dll'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with Astaroth was detected. Astaroth is infostealer malware that has evolved over time to leverage living-off-the-land evasion techniques while remaining fileless in its execution. Most recently, it uses legitimate Windows binary ExtExport.exe to load malicious DLL's.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_nanocorerat_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time FROM file f JOIN hash h ON f.path=h.path WHERE f.path LIKE 'C:\\Users\\%\\AppData\\Roaming\\%%\\run.dat' AND f.directory LIKE regex_match(f.directory, '.*AppData\\\\Roaming\\\\[A-F0-9]{8}-[A-F0-9]{4}-[A-F0-9]{4}-[A-F0-9]{4}-[A-F0-9]{12}', 0) AND f.filename LIKE 'run.dat'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with NanoCore RAT was detected. NanoCore RAT is a Remote Access Trojan (RAT) that has many capabilities including arbitrary command execution, file exfiltration, keylogging, and interacting with peripherals such as webcams.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_njrat_filepath": {
            "query": "SELECT key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') as last_modified FROM registry WHERE key LIKE 'HKEY_USERS\\%\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\RUN' AND name LIKE regex_match(name, '[a-f0-9]{32}', 0) AND data LIKE regex_match(data, '.*\\\\AppData\\\\Local\\\\Temp\\\\(svchost|system)\\.exe', 0); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with njRAT was detected. njRAT is a Remote Access Trojan (RAT) that has many capabilities including arbitrary command execution, file exfiltration, keylogging,and interacting with peripherals such as webcams.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_zerocleare_registry": {
            "query": "SELECT key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') as last_modified FROM registry WHERE key LIKE 'HKEY_LOCAL_MACHINE\\SYSTEM\\CONTROLSET001\\SERVICES\\SOYDSK'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A registry key associated with ZeroCleare was created. ZeroCleare is a destructive wiper damaging disk partitions and overwriting the Master Boot Record (MBR) of infected machines.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_scartrojan_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time FROM file f JOIN hash h ON f.path=h.path WHERE (f.path LIKE 'C:\\Users\\%\\AppData\\Roaming\\%%\\MsdUpdate.exe' OR f.path LIKE 'C:\\Users\\%\\AppData\\Roaming\\%%\\DysonPart.exe' OR f.path LIKE 'C:\\Users\\%\\AppData\\Roaming\\%%\\SmartMega.exe') AND f.directory LIKE regex_match(f.directory, '.*AppData\\\\Roaming\\\\(SmartMega|MSDUpdate|DysonPart)',0) AND f.filename LIKE regex_match(f.filename,'(MsdUpdate|DysonPart|SmartMega)\\.exe',0); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with SCAR Trojan was detected. SCAR Trojan is a dropper malware that is part of a botnet and calls out to command and control (C2) servers to download additional paylaods. This Trojan is associated with APT33 which use destructive techniques such as disk wiping.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_maze_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time FROM file f JOIN hash h ON f.path=h.path WHERE f.path LIKE 'C:\\Users\\DECRYPT-FILES.txt' AND f.filename LIKE 'DECRYPT-FILES.txt'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with Maze was detected. Maze is a ransomware that has been used in high-profile, targeted attacks. Attackers using Maze have demanded payment to recover the encrypted files and threaten public disclosure of stolen files if victims do not pay. \n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_prolock_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE 'C:\\ProgramData\\WinMgr.bmp'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with Prolock was detected. Prolock is a ransomware that is a rebrand of the PwndLocker ransomware. Prolock targets enterprise networks and demands ransoms of anywhere between $175K - $660K. It attempts to encrypt any file that it deems is not used for the system, and a ransom note will be dropped in every folder that contains an encrypted file. The ransomware is kept embedded in a bitmap image and is extracted when an actor with full system access executes a script to extract the ransomware from the bitmap and execute it in memory.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_ragnarlocker_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE 'RGNR_%' OR f.path LIKE '%.ragnar_%'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with Ragnar Locker was detected. Ragnar Locker is ransomware hidden within a virtual machine to avoid endpoint detection. An MSI package deploys an old version of VirtualBox responsible for starting the virtual machine in a headless mode that is hidden from the user.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_pipemon_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time FROM file f JOIN hash h ON f.path=h.path WHERE (f.path LIKE 'C:\\Windows\\System32\\spool\\prtprocs\\x64\\EntAppsvc.dll' OR f.path LIKE 'C:\\Windows\\System32\\spool\\prtprocs\\x64\\epcprtsvc.dll' OR f.path LIKE 'C:\\Windows\\System32\\spool\\prtprocs\\x64\\DEment.dll' OR f.path LIKE 'C:\\Windows\\System32\\spool\\prtprocs\\x64\\Interactive.dll'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with PipeMon Trojan was detected. PipeMon Trojan is a modular backdoor whose payloads are DLLs and are stored where Windows Print Processors are located. After the payloads are placed in this location, they are registered as Print Processors.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_asyncrat_mutex_detected": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND object_name LIKE 'AsyncMutex_%' OR object_name LIKE '!%MTX!%' ESCAPE '!'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex known to be associated with AsyncRAT was seen being created on the system. AsyncRAT is a Remote Access Tool (RAT) designed to remotely monitor and control targeted computers through an encrypted connection. The tool itself is open source and written in Microsoft's C# language. \n",
            "platform": [
                "windows"
            ]
        },
        "malware_indigodrop_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time FROM file f JOIN hash h ON f.path=h.path WHERE f.path LIKE 'C:\\Users\\%\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\anything.exe'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with IndigoDrop was detected. IndigoDrop is a modular trojan that is known to be distributed by malicious documents, the file detected is used as persistence.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_valak_registry": {
            "query": "SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') AS last_modified  FROM registry  WHERE key LIKE 'HKEY_CURRENT_USER\\SOFTWARE\\APPLICATIONCONTAINER\\APPSW64'  AND (name LIKE 'ShimV4' OR name LIKE 'SetupServiceKey'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A registry key associated with Valak was created. Valak is a modular trojan that can load malware and leverage many of its own plugins to perform activities such as information stealing. Valak uses the registry to store different components used in later execution.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_nephilim_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE ((f.directory LIKE 'C:\\Users\\%%' AND (f.filename LIKE regex_match(f.filename, '\\S+\\.(N|M)E(PH|F)(I|1)L(I|1)(N|M)$', 0) OR f.filename LIKE regex_match(f.filename, '\\S+\\.OFFWHITE$', 0) OR f.filename LIKE regex_match(f.filename, '\\S+\\.TELEGRAM$', 0) OR f.filename LIKE regex_match(f.filename, '\\S+\\.SIGARETA$', 0) OR f.filename LIKE regex_match(f.filename, '\\S+\\.TRAPGET$', 0))) OR (f.directory = 'C:' AND (f.filename LIKE regex_match(f.filename, 'NE(PH|F)(I|1)L(I|1)(N|M)-(README|DECRYPT)\\.\\S+', 0) OR f.filename LIKE regex_match(f.filename, 'OFFWHITE-MANUAL\\.\\S+', 0) OR f.filename LIKE regex_match(f.filename, 'TELEGRAM-RECOVER\\.\\S+', 0) OR f.filename LIKE regex_match(f.filename, 'SIGARETA-RESTORE\\.\\S+', 0) OR f.filename LIKE regex_match(f.filename, 'TRAPGET-INSTRUCTION\\.\\S+', 0))));  ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with Nephilim was detected. Nephilim, also called Nefilim, is a ransomware used in targeted attacks, particularly against oil and energy companies. It is usually delivered via vulnerable RDP services. The encryption is done with a combination of AES-128 for the files and RSA-2048 to encrypt the AES key. After infection, encrypted files are given one of the following extensions - .NEFILIM, .NEF1LIM, .NEPHILIM, .MEFILIN, .NEPHILIN, .TELEGRAM, .OFFWHITE, .SIGARETA and .TRAPGET\n",
            "platform": [
                "windows"
            ]
        },
        "tool_lazagne_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE 'C:\\Users\\%\\AppData\\Local\\Temp\\%\\laZagne%'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with LaZagne was detected. LaZagne is a post-exploitation, open-source tool used to recover stored passwords on a system. The LaZagne executables are Python scripts bundled with the necessary dependencies using Pyinstaller. It has been used in various espionage campaigns, particularly those targeting the Middle East, Hong Kong and the US.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_nephilim_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND (object_name LIKE 'sofos delaet sosos' OR object_name LIKE '%plyvut v karmany rekoy. My khodim po krayu nozha' OR object_name LIKE 'ONA MOYA ROZA I YA EE LUBLUUUUUUUU%' OR object_name LIKE 'na mne prigaet zhopa, pamc, pamc, pamc%' OR object_name LIKE '%sina, ti bezdelnik. a mne kak to pohui%'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with Nephilim was detected. Nephilim, also called Nefilim, is a ransomware used in targeted attacks, particularly against oil and energy companies. It is usually delivered via vulnerable RDP services. The encryption is done with a combination of AES-128 for the files and RSA-2048 to encrypt the AES key. After infection, encrypted files are given the .NEFILIM or .NEPHILIM extension.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_vidar_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE 'C:\\ProgramData\\%\\files\\%' AND f.filename IN ('passwords.txt', 'information.txt', 'outlook.txt', 'Soft'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with Vidar was detected. Vidar is an information stealer that has been used by threat actors along with GandCrab. Vidar uses encrypted strings for file paths, browser names, wallets and the names of the applications that it targets, such as Telegram. Vidar is capable of stealing cookies, usernames, passwords, card details and other system information. The gathered data is later zipped and sent to a command and control (C2) server.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_strongpity3_registry": {
            "query": "SELECT key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') as last_modified FROM registry WHERE ((key LIKE '%\\SYSTEM\\CurrentControlSet\\Services\\dusntask' OR key LIKE '%\\System\\CurrentControlSet\\Services\\PickerSrv' OR key LIKE '%\\System\\CurrentControlSet\\Services\\netplviz') AND name LIKE '%ImagePath') OR (key LIKE 'HKEY_USERS\\%\\Software\\Microsoft\\Windows\\CurrentVersion\\Run' AND name = 'OperaSyncService'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "This query detects the presence of a registry key/dataname combination known to be created during StrongPity3 execution. StrongPity3 is a spyware capable of detecting and altering anti-malware protections and exfiltration data. It uses the Registry to achieve persistence.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_lemonduck_filepath_detected": {
            "query": "'SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.path LIKE 'C:\\Users\\%%\\Local\\Temp\\%') AND (f.filename LIKE 'if.bin' OR f.filename LIKE 'kr.bin' OR f.filename LIKE 'mr6.bin.exe.ori'); ' ",
            "interval": 86400,
            "snapshot": true,
            "description": "A file path associated with Lemon Duck was detected. Lemon Duck is a mining botnet with automated spreading capabilities. It drops several payloads on the system that are capable of mining Monero and spreading across a network using Mimikatz.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_strongpity3_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.path LIKE 'C:\\Windows\\SysWOW64\\IpOve32.exe' OR f.path LIKE 'C:\\System32\\IpOve32.exe' OR f.path LIKE 'C:\\Windows\\System32\\IpOve32.exe' OR f.path LIKE 'C:\\Windows\\SysWOW64\\netplviz.exe' OR f.path LIKE 'C:\\System32\\netplviz.exe' OR f.path LIKE 'C:\\Windows\\System32\\netplviz.exe' OR f.path LIKE 'C:\\Documents and Settings\\%\\Local Settings\\Temp\\%\\evntwn32.xml' OR f.path LIKE 'C:\\Users\\%\\AppData\\Local\\Temp\\%\\evntwn32.xml' OR f.path LIKE 'C:\\Windows\\System32\\rmaserv.exe' OR f.path LIKE 'C:\\Windows\\System32\\winprint32.exe' OR f.path LIKE 'C:\\Users\\%\\AppData\\Local\\Temp\\%\\mssqldbserv.xml' OR f.path LIKE 'C:\\Windows\\SysWOW64\\dusntask.exe' OR f.path LIKE 'C:\\Windows\\SysWOW64\\dusntask.exe' OR f.path LIKE 'C:\\Windows\\SysWOW64\\winpickr.exe' OR f.path LIKE 'C:\\Users\\%\\AppData\\Local\\Temp\\%\\ntuis32.exe' OR f.path LIKE 'C:\\Windows\\Temp\\%\\ntuis32.exe' OR f.path LIKE 'C:\\Windows\\SysWOW64\\consent32.exe' OR f.path LIKE 'C:\\Users\\%\\AppData\\Local\\Temp\\Opera\\srvolpsm.exe' OR f.path LIKE 'C:\\Users\\%\\AppData\\Local\\Temp\\Opera\\sivsnui.exe' OR f.path LIKE 'C:\\Users\\%\\AppData\\Local\\Temp\\Opera\\intervpnmix2.exe'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with StrongPity3 was created. StrongPity3 is a spyware capable of detecting and altering anti-malware protections and data exfiltration.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_prometei_registry": {
            "query": "'SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') AS last_modified FROM registry WHERE (key LIKE '%SOFTWARE\\Microsoft\\Fax' AND name LIKE 'EncryptedMachineKeyId'); ' ",
            "interval": 86400,
            "snapshot": true,
            "description": "A registry entry associated with the Prometei botnet was detected. Prometei is a botnet that also contains malicious capabilities such as credential stealing, Monero mining, and lateral movement.\n",
            "platform": [
                "linux"
            ]
        },
        "ransomware_darkside_filepath": {
            "query": "SELECT DISTINCT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE ((f.path LIKE 'C:\\Users\\%%' AND f.filename LIKE regex_match(f.filename, 'README\\.[a-zA-Z0-9]{8}\\.TXT', 0)) OR (f.path LIKE 'C:\\Users\\%%' AND f.filename LIKE regex_match(f.filename, 'LOG\\.[a-zA-Z0-9]{8}\\.TXT', 0))); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with DarkSide was created. DarkSide is a ransomware capable of encrypting local drives and network shares. It is also capable of encrypting a specific directory that is passed to it through a command-line argument. It inhibits system recovery by deleting shadow copies.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_lockbit_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.filename LIKE '%.lockbit' OR f.filename LIKE '%.abcd'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "LockBit is a ransomware used in targeted attacks. It attempts to use the VBC (Visual Basic Compiler) utility, which is a signed Microsoft executable, to compile and execute code on the fly. If the vbc.exe file is not found, LockBit downloads a copy of the legitimate executable from a malicious URL. LockBit also creates a ransom note called Restore-My-Files.txt in every directory. After infection, encrypted files are given the .lockbit or .abcd extension.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_hakbit_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE (object_type='Mutant' AND object_name LIKE 'c1a76b5a-12ab-45c5-b9d9-d692faa6e7a2'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with Hakbit was created. Hakbit is a ransomware capable of evading sandbox analysis, deleting shadow copies, killing unwanted processes, moving laterally, encryption and data exfiltration. \n",
            "platform": [
                "windows"
            ]
        },
        "malware_nokki_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.path LIKE 'C:\\Users\\%\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup' OR f.path LIKE 'C:\\Users\\%\\AppData\\Local\\MicroSoft Update%' OR f.path LIKE 'C:\\Users\\%\\AppData\\Local\\Temp') AND (f.filename LIKE 'Antdule.lnk' OR f.filename LIKE 'svServiceUpdate.exe' OR f.filename LIKE 'uplog.tmp'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "KONNI and NOKKI are Remote Administration Tools (RATs) involved in a series of attacks focused on politically-motivated victims in the Korean peninsula, Eurasia and Southeast Asia. Due to code similarities and overlapping infrastructure, researchers suspect NOKKI and KONNI were developed by the same malicious actors. The payload is usually delivered via emails with attachments.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_lodarat_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC')  AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC')  AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC')  AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC')  AS creation_time  FROM file f JOIN hash h ON f.path=h.path  WHERE f.path LIKE 'C:\\Users\\%\\AppData\\Roaming\\Windata\\%.exe'; AND f.filename LIKE regex_match(f.filename, '([a-zA-Z]{6}|svchost)\\.exe', 0); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with LodaRAT was detected. LodaRAT is a Remote Access Trojan (RAT) capable of keylogging, capturing audio, and taking screenshots.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_funicorn_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch', 'UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.directory LIKE 'C:\\Users\\%%' AND f.filename LIKE regex_match(f.filename, '\\S+\\.fuckunicornhtrhrtjrjy$', 0)); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with FuckUnicorn ransomware was detected. FuckUnicorn has been targeting computers in Italy by tricking victims into downloading a fake contact tracing app, named Immuni, that promises to provide real-time updates for the COVID-19 outbreak. Upon executing the malware it displays a fake Coronavirus Map from the Center for Systems Science and Engineering at Johns Hopkins University. The ransomware adds the .fuckunicornhtrhrtjrjy extensions to names of encrypted files.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_eccentricbandwagon_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch', 'UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE ((f.directory LIKE 'C:\\Users\\%\\AppData\\Local\\Temp\\Downloads' AND f.filename LIKE regex_match(f.filename, 'tmp_\\S+_(0[1-9]|1[0-2])(0[1-9]|[1-2]\\d|3[0-1])_(2[0-3]|[01]\\d)[0-5]\\d[0-5]\\d$', 0)) OR (f.directory LIKE 'C:\\Users\\%\\AppData\\Local\\Temp\\GoogleChrome' AND f.filename LIKE regex_match(f.filename, 'chromeupdater_ps_\\d{4}(0[1-9]|1[0-2])(0[1-9]|[1-2]\\d|3[0-1])_(2[0-3]|[01]\\d)[0-5]\\d[0-5]\\d_\\d{3}_\\d{1,4}$', 0)) OR (f.directory LIKE 'C:\\Users\\%\\AppData\\Local\\Temp\\TrendMicroUpdates' AND f.filename LIKE regex_match(f.filename, 'update_(0[1-9]|1[0-2])(0[1-9]|[1-2]\\d|3[0-1])_(2[0-3]|[01]\\d)[0-5]\\d[0-5]\\d$', 0))); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with EccentricBandwagon RAT was detected. This family of malware is used as a reconnaissance tool and some variants have keylogging and screen capture functionality.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_nibiru_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch', 'UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.directory LIKE 'C:\\Users\\%%' AND f.filename LIKE regex_match(f.filename, '\\S+\\.Nibiru$', 0)); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with Nibiru ransomware was detected. It adds a .Nibiru extension to names of encrypted files.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_mabezat_filepath_detected": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.filename LIKE 'zpharaoh.exe' AND f.path LIKE 'C:\\'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A file path associated with Mabezat has been detected. Mabezat is a worm that infects Windows executable files and can be spread through email attachments, network shared drives, USB drives and CD burning. It contains capabilities of downloading and executing additional payloads from a command and control server.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_arcane_filepath_detected": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.filename LIKE 'U3LZDGVTLKNOYXJBXQ'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A file path associated with Arcane was created. Arcane is a .NET information stealer that collects and extracts information regarding cryptocurrency wallets, instant messaging sessions, and browser information.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_chthonic_mutex_detected": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND (object_name LIKE 'TmpNtMutex' OR object_name LIKE 'NtMute' OR object_name LIKE 'SystemMutex' OR object_name LIKE '\\{03B8A4CD-37A3-3A5D-99BA-2F2544D2A32F\\}' OR object_name LIKE '\\{B4810E6F-2321-7F0D-1818-CCDBE577D2BD\\}' OR object_name LIKE '\\{B4810E6F-2321-770D-1818-CCDBE577D2BD\\}' OR object_name LIKE '\\{FB8C1EB1-2376-7F0D-C608-C1943B67DFF2\\}') ; ",
            "interval": 86400,
            "snapshot": true,
            "description": "Chthonic is a Remote Access Tool (RAT) that has evolved from Zeus. It may be delivered either through the Andromeda botnet or by phishing emails containing a malicious document as part of a targeted attack. Once executed, the main loader begins downloading additional components to expand its arsenal. Modules include capabilities to collect system information, steal passwords, keylogging and video capture from the webcam or screen. Chthonic is primarily aimed at stealing credentials for online banking, targeting over 150 banks and twenty payment systems across fifteen countries. The primary targets include the UK, Spain, the US, Russia and Japan.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_blackice_mutex_detected": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND object_name LIKE '%blackicemutex%'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with Blackice has been detected. Blackice is a worm that spreads via infecting Office documents such as Excel or Word. It can also spread by making copies of itself on local and shared drives.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_zebrocy_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.directory LIKE 'C:\\Users\\%\\AppData\\Roaming\\Personalization\\EUDC\\Policies' OR f.directory LIKE 'C:\\Users\\%\\AppData\\Roaming\\UserData\\Multimedia\\Policies' AND f.filename LIKE regex_match(f.filename, '^\\d{40}$', 0));  ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with Zebrocy was detected. Zebrocy is a backdoor that is capable of exfiltrating the infected system's information such as MAC address and hostname to the C2 and accept commands from C2 to perform other activities such as command execution.\n",
            "platform": [
                "windows"
            ]
        }
    }
}