{
    "platform": "windows",
    "queries": {
        "malware_bisonal_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size,  DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time,  DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified,  DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time,  DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE 'C:\\Windows\\Tasks\\conime.exe'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A file path associated with Bisonal was created. Bisonal is a Remote Access Trojan (RAT) that usually targets government, military or other public and private organizations in South Korea, Japan and Russia. The primary infection vector is via spear phishing campaigns with malicious documents attached. Bisonal is also known for using Dynamic DNS for its Command and Control servers.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_bisonal_registry": {
            "query": "SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') AS last_modified FROM registry  WHERE (key LIKE 'HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432NODE\\MICROSOFT\\WINDOWS NT\\CURRENTVERSION\\WINLOGON'  OR key LIKE 'HKEY_USERS\\%\\Software\\Microsoft\\Windows\\CurrentVersion\\Run' OR key LIKE 'HKEY_LOCAL_MACHINE\\SYSTEM\\CONTROLSET001\\SERVICES\\FASTUSERSWITCHINGCOMPATIBILITY\\PARAMETERS') AND (name IN ('mismyou', 'Microsofttool', 'workhelper') OR data LIKE 'netcat27.dll' OR data LIKE '%temp\\pvcu.dll%' OR data LIKE '%Windows\\Tasks\\conime.exe'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A registry key associated with Bisonal was created. Bisonal is a Remote Access Trojan (RAT) that usually targets government, military or other public and private organizations in South Korea, Japan and Russia. The primary infection vector is via spear phishing campaigns with malicious documents attached. Bisonal is also known for using Dynamic DNS for its Command and Control servers.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_hansom": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch', 'UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') as last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') as last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') as creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE '%HANSOM_README.txt'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "Hansom is a ransomware plugin used by the CRAT malware family. Instead of encrypting targeted files, Hansom will generate random passwords and use them to protect RAR archives containing the files held for ransom. The passswords are archived themselves and encrypted with a public key.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_hansom_registry_persistence": {
            "query": "SELECT key, path, name, data, DATETIME(mtime, 'unixepoch', 'UTC') AS last_modified FROM registry WHERE (key LIKE 'HKEY_USERS\\S-%\\Software\\Microsoft\\Windows\\CurrentVersion\\Run' OR key LIKE 'HKEY_USERS\\S-%\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce') AND name='HANSOM' AND data LIKE regex_match(data,'^regsvr32\\.exe\\s\\/s\\s[A-Z]:\\\\.+\\.dll$',0); ",
            "interval": 86400,
            "snapshot": true,
            "description": "Hansom is a ransomware plugin used by the CRAT malware family. Instead of encrypting targeted files, Hansom will generate random passwords and use them to protect RAR archives containing the files held for ransom. The passswords are archived themselves and encrypted with a public key.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_azorult_registry": {
            "query": "SELECT key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') as last_modified FROM registry WHERE key LIKE '%SYSTEM%SERVICES%LOCALNETSERVICE%' AND name LIKE '%ImagePath';",
            "interval": 86400,
            "snapshot": true,
            "description": "This query detects the presence of a registry key/dataname combination known to be created during Azorult execution. Azorult is an information stealer capable of exfiltrating sensitive user data such as files, passwords, and cryptocurrency wallet keys.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_windex_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.path LIKE '%\\AppData\\Roaming\\Microsoft\\Repairs\\sha.dll' OR f.path LIKE '%\\AppData\\Roaming\\Microsoft\\Caches\\Files\\usd.dll' OR f.path LIKE '%\\AppData\\Roaming\\Microsoft\\Identities\\Administrator\\arc.dll' OR f.path LIKE '%\\AppData\\Roaming\\Microsoft\\Common\\Shared.dll' OR f.path LIKE '%\\AppData\\Roaming\\Microsoft\\Shared\\Modules\\fil.dll' OR f.path LIKE '%\\AppData\\Roaming\\Microsoft\\Windows\\Addins\\att.dll' OR f.path LIKE '%\\AppData\\Roaming\\Microsoft\\Defender\\launch.exe' OR f.path LIKE '%\\AppData\\Roaming\\Microsoft\\Messenger\\Extension\\WdExt.exe' OR f.path LIKE '%\\Windows\\SysWOW64\\mscaps.exe'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with Windex was detected. Windex is malware found hosted on a North Korean news site and used in a watering hole attack. Various file artifacts created during runtime are dropped to the Microsoft subdirectory within APPDATA.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_dcrat_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime,'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE 'C:\\Users\\%\\%\\Temp\\dclib\\%' AND f.path LIKE regex_match(f.path,'C:\\\\Users\\\\.+\\\\Temp\\\\dclib\\\\.+',0); ",
            "interval": 86400,
            "snapshot": true,
            "description": "DCRat (or Dark Crystal RAT) is both a remote administration tool (RAT) and a credential stealer. It is written in the C# .NET language and easily debugged through the use of proper analysis tools, but the family has remained prevalent since 2019.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_CRAT_loader_registry_persistence": {
            "query": "SELECT key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') AS last_modified FROM registry WHERE (key LIKE 'HKEY_LOCAL_MACHINE\\SYSTEM\\ControlSet001\\Control\\Session Manager' AND name='PendingFileRenameOperations' AND data LIKE regex_match(data,'^.:\\Windows\\system32\\MstscConfig\\.exe$',0)) OR ((key LIKE 'HKEY_USERS\\S-%\\Software\\Microsoft\\Windows\\CurrentVersion\\Run' OR key LIKE 'HKEY_USERS\\S-%\\Software\\Microsoft\\Windows\\CurrentVersion\\RunOnce') AND ((name='Microsoft Internet Explorer' AND data LIKE regex_match(data,'.+\\.exe$',0)) OR (name='MaintenanceService' AND data LIKE regex_match(data,'.+AppData\\Local\\Mozilla\\Maintenance\\sService\\MaintenanceService.exe.lnk$',0)))); ",
            "interval": 86400,
            "snapshot": true,
            "description": "The CRAT malware family consists of multiple RAT capabilities, additional plugins and a variety of detection-evasion techniques. Linked attacks consists of a highly modular malware that can function as a standalone RAT and  download and activate additional malicious plugins from its C2 servers. The core module is often injected and reflected into process memory address space by a PE loader. The loader will establish persistence on the infected host before executing code for anti-analysis checks.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_CRAT_loader_scheduled_task_persistence": {
            "query": "SELECT name, path, action, datetime(last_run_time, 'unixepoch', 'UTC') as last_run_time FROM scheduled_tasks WHERE name LIKE regex_match(name,'(Maintenance|Cloud)\\sService',0) AND action LIKE regex_match(action,'.+AppData\\Local\\Mozilla\\(Maintenance|Cloud)\\sService\\(Maintenance|Cloud)Service\\.exe$',0); ",
            "interval": 86400,
            "snapshot": true,
            "description": "The CRAT malware family consists of multiple RAT capabilities, additional plugins and a variety of detection-evasion techniques. Linked attacks consists of a highly modular malware that can function as a standalone RAT and  download and activate additional malicious plugins from its C2 servers. The core module is often injected and reflected into process memory address space by a PE loader. The loader will establish persistence on the infected host before executing code for anti-analysis checks.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_CRAT_loader_mutex": {
            "query": "SELECT session_id, object_name, object_type from winbaseobj WHERE object_type='Mutant' AND (object_name='CRAT' OR object_name LIKE regex_match(object_name,'^CRAT2[\\d\\.]+$',0) OR object_name LIKE regex_match(object_name,'^Crat(ScreenCapture|ClipboardMonitor2|KeyLog2)Mutex$',0)); ",
            "interval": 86400,
            "snapshot": true,
            "description": "The CRAT malware family consists of multiple RAT capabilities, additional plugins and a variety of detection-evasion techniques. Linked attacks consists of a highly modular malware that can function as a standalone RAT and  download and activate additional malicious plugins from its C2 servers. The core module is often injected and reflected into process memory address space by a PE loader. The loader will establish persistence on the infected host before executing code for anti-analysis checks.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_ap0calypserat_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE '%Windows\\apocalyps32.exe'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with Ap0calypseRAT was created. Ap0calypseRAT is a Remote Access Trojan (RAT) capable of arbitrary command execution, keylogging, remote desktop access, and file exfiltration.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_raccoon_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND (object_name LIKE 'rc_%'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with Raccoon info stealer was created. Raccoon is a stealer that collects passwords, cookies, autofill from all popular browsers (including FireFox x64), CC data, system information, and almost all existing desktop wallets of cryptocurrencies\n",
            "platform": [
                "windows"
            ]
        },
        "malware_cryptbot_registry": {
            "query": "SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') AS last_modified FROM registry WHERE (data LIKE '%ProgramData\\Cryptbot\\margin.exe%'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A registry key associated with Cryptbot was created. Cryptbot is a trojan designed to steal passwords, cryptowallets, browser credentials, and other information.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_proyectorat_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.path LIKE '%\\AppData\\Roaming\\LocalAdmin\\Conf.ini' OR f.path LIKE '%\\AppData\\Roaming\\LocalOffice\\Conf.ini' OR f.path LIKE '%\\AppData\\Roaming\\Office\\Conf.ini' OR f.path LIKE '%\\AppData\\Roaming\\AgentLog\\Conf.ini' OR f.path LIKE '%\\AppData\\Roaming\\AgentLogs\\Conf.ini' OR f.path LIKE '%\\AppData\\Roaming\\Sys'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with Proyecto RAT was detected. Proyecto RAT is a remote administration tool delivered via emails with malicious RTF files attached. This threat is capable of recording keystrokes, downloading additional files, executing commands, using the webcam and more. The latest campaign uses a disposable email service called YOPmail as its command and control, and targets financial institutions and government agencies in South America.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_ryuk_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE '%RyukReadMe.txt' OR f.path LIKE '%RyukReadMe.html' OR f.path LIKE '%RyukReadMe.lnk'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with Ryuk was detected. Ryuk is a ransomware known for targeting large organizations and asking for rather large ransom payments to recover the encrypted files. The infection has been associated with emails that contain malicious attachments that first deliver Emotet, which is used to deliver modular payloads such as Ryuk. \n",
            "platform": [
                "windows"
            ]
        },
        "malware_sality_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND object_name LIKE '%.exeM_%_'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with Sality was created. Sality is a polymorphic file infector and one of the most resilient malware in the threat landscape. Once a Sality sample bypasses perimeter security, its goal is to download and execute additional malware components. To avoid infecting the same process multiple times, Sality creates a mutex with the process name and the decimal representation of the process ID.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_proyectorat_registry": {
            "query": "SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') AS last_modified FROM registry WHERE (key LIKE '%\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\RUN' OR key LIKE '%\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\RUNONCE') AND data LIKE '%\\AppData\\Roaming\\LocalAdmin\\%.exe' OR data LIKE '%\\AppData\\Roaming\\LocalOffice\\%.exe' OR data LIKE '%\\AppData\\Roaming\\Office\\%.exe' OR data LIKE '%\\AppData\\Roaming\\AgentLogs\\%.exe' OR data LIKE '%\\AppData\\Roaming\\AgentLog\\%.exe'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "Registry keys associated with Proyecto RAT were created. Proyecto RAT is a remote administration tool delivered via emails with malicious RTF files attached. This threat is capable of recording keystrokes, downloading additional files, executing commands, using the webcam and more. The latest campaign uses a disposable email service called YOPmail as its command and control, and targets financial institutions and government agencies in South America.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_betabot_registry": {
            "query": "SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') AS last_modified FROM registry WHERE (key LIKE '%\\SOFTWARE\\WIN7ZIP' AND name LIKE 'Uuid'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A registry key associated with BetaBot was created. BetaBot, also known as Neurevt, is a botnet with a large number of capabilities, such as downloading additional malware, stealing banking data, DDoS attacks and website sniffing. Modules for a rootkit and a crypto-currency miner were added in recent years. It also attempts to disable security-related applications and even blocks some code injection techniques and other malicious activity to prevent other malware from running on the system.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_ryuk_registry": {
            "query": "SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') AS last_modified FROM registry WHERE key LIKE '%\\Software\\Microsoft\\Windows\\CurrentVersion\\Run' AND name LIKE 'svchos'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A registry key associated with Ryuk was created. Ryuk is a ransomware known for targeting large organizations and asking for rather large ransom payments to recover the encrypted files. The infection has been associated with emails that contain malicious attachments that first deliver Emotet, which is used to deliver modular payloads such as Ryuk. To achieve persistence, Ryuk adds a registry key to execute itself at every login.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_netwirerat_registry": {
            "query": "SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') AS last_modified FROM registry WHERE key LIKE '%SOFTWARE\\NETWIRE'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A registry key associated with NetWire RAT was created. NetWire is a publicly available, multiplatform remote administration tool (RAT) that has been used by criminal and APT groups. Although it includes remote control capabilities, its functionality seems focused on password stealing and keylogging. Newer variants of NetWire are capable of scraping credit card data and reading data from connected USB devices.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_glupteba_registry": {
            "query": "SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') AS last_modified FROM registry  WHERE key LIKE 'HKEY_USERS\\%\\SOFTWARE\\MICROSOFT\\TESTAPP'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A registry key associated with Glupteba was created. Glupteba is malware providing easy botnet management. It is capable of stealing credentials, collecting system information, and adding the infected machine to it's botnet.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_vilsel_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND object_name LIKE 'Pro3'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with Vilsel was created. Vilsel is a trojan that is capable of downloading additional malware, and modifying system configurations. \n",
            "platform": [
                "windows"
            ]
        },
        "malware_smominru_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND object_name LIKE 'Windows 10 Pro02'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with Smominru was created. Smominru (also known as MyKings) is a botnet that uses a trojan with a modular design for spreading. Based on the modules installed, Smominru is capable of lateral movement exploiting known vulnerabilities such as EternalBlue, brute-forcing services such as RDP, stealing credentials, and mining cryptocurrency.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_revengerat_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND object_name LIKE '%RV_MUTEX%'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with RevengeRAT was created. RevengeRAT is a Remote Access Trojan (RAT) capable of stealing credentials, executing commands, manipulating system configurations, and interacting with peripherals. \n",
            "platform": [
                "windows"
            ]
        },
        "malware_plasmarat_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND (object_name LIKE '4919245' OR object_name LIKE '3818273' OR object_name LIKE '83729184726481' OR object_name LIKE '48727194728194'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with PlasmaRAT was created. PlasmaRAT is a Remote Access Trojan (RAT) that has many capabilities including mining, denial of service, remote desktop access, and keylogging. PlasmaRAT's sourcecode is freely available online and has been seen used by threat actors such as APT33.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_obliquerat_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND object_name LIKE regex_match(object_name, 'Oblique|t80\\d|gaia\\d', 0); \n",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with ObliqueRAT was created. ObliqueRAT is a remote access trojan (RAT) which provides the adversary controlling it with access to the files on disk, webcam, screenshots as well as the ability to install additional malware. This family of RATs is also known to exfiltrate files on removable drives and from the recycling bin.",
            "platform": [
                "windows"
            ]
        },
        "ransomware_medusa_registry": {
            "query": "SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') AS last_modified FROM registry  WHERE key LIKE 'HKEY_USERS\\%\\Software\\MEDUSA'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A registry key associated with MedusaLocker was created. MedusaLocker is ransomware that encrypts files with the AES crypto algorithm. Persistence is established by creating a scheduled task to execute a copy of itself from the AppData Roaming folder. A notable feature of MedusaLocker is that it manipulates the registry to allow it to reach mapped network drives for encryption.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_wastedlocker_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch', 'UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE '%wasted_info'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "WastedLocker is ransomware commonly activated by the adversary on several different systems within the same targeted corporate network. It is dropped to the host through a series of privilege escalation and lateral movement. Encrypted files are written to disk with an extension consisting of the name of the target and the wasted suffix. For each encrypted file, a ransom note is created using the original file name, target name extension, and the wasted_info suffix. ",
            "platform": [
                "windows"
            ]
        },
        "ransomware_wastedlocker_initial_compromise": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch', 'UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.path LIKE 'C:\\Users\\%\\AppData\\%\\Temp\\Temp%Chrome%Update%\\%.js') AND f.path LIKE regex_match(f.path,'C:\\\\Users\\\\[^\\\\]+\\\\AppData\\\\Temp\\\\Temp\\d+_Chrome\\.Update\\.[^\\\\]+\\.zip\\\\Chrome\\.Update\\.[^\\\\]+\\.js$',0); ",
            "interval": 86400,
            "snapshot": true,
            "description": "WastedLocker is ransomware commonly activated by the adversary on several different systems within the same targeted corporate network. It is dropped to the host through a series of privilege escalation and lateral movement. The initial compromise involves a fake Google Chrome web browser update delivered as a drive-by download from a compromised website.",
            "platform": [
                "windows"
            ]
        },
        "malware_frenchy_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND object_name LIKE 'frenchy_shellcode_%'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with Frenchy was created. Frenchy is a shellcode tool leveraged by many malware families including Emotet and AgentTesla. The tool facilitates evading detection while launching malicious processes. \n",
            "platform": [
                "windows"
            ]
        },
        "malware_blackrat_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND object_name LIKE 'qSILlzCwXBSrQ1Vb72'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with BlackRAT was created. BlackRAT is a remote access trojan (RAT) that is capable of downloading additional malware, executing commands, and exfiltration of information from the infected machine.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_ap0calypserat_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND object_name LIKE 'apocalyps32'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with Ap0calypseRAT was created. Ap0calypseRAT is a Remote Access Trojan (RAT) that has many capabilities including arbitrary command execution, keylogging, remote desktop access, and file exfiltration. The primary infection vector of Ap0calypseRAT is unknown. This RAT has shown up periodically on underground forums, and has been seen as an additional payload dropped by other malware families.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_chernolocker_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE '%(.CHERNOLOCKER)' OR f.path LIKE '%(.chernolocker)' OR f.path LIKE '%(.filelocker@protonmail.ch)' OR f.path LIKE '%.(.filelocker@protonmail.ch)'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with Chernolocker was detected. ChernoLocker is ransomware using AES-256 to encrypt a victim's files and requests Bitcoin for the ransom payment. The attacker's e-mail address and choice of encrypted file extension has changed over time with each variant.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_gandcrab_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND (object_name LIKE 'pc_group=%ransom_id%'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with Gandcrab was created. Gandcrab is a ransomware variant first observed in January 2018. It has been delivered with email spam through the Necurs botnet, RIG Exploit Kit, GrandSoft Exploit Kit, and as part of the EITest Campaign.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_limerat_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND (object_name LIKE 'C9C1EE6A969F' OR object_name LIKE '6691A1ED40AE' OR object_name LIKE 'I0xpbWVSQVQ=' OR object_name LIKE '_Lime_Worm_'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with LimeRAT was created. LimeRAT is a .NET Remote Administration Tool for Windows (RAT) with many plugins. Existing plugins provide the ability to mine the Monero (XMR) cryptocurrency, perform a Distributed Denial of Service (DDoS) attack, encrypt files on all drives including USB, steal passwords, replace cryptocurrency addresses with the attackers and more.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_quasarrat_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND (object_name LIKE 'QSR_MUTEX_%' OR object_name LIKE '123AKs82kA,ylAo2kAlUS2kYkala!' OR object_name LIKE 'MUTEX___________________'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with QuasarRAT was created. QuasarRAT is an open source 'Remote Administration Tool' that is often used maliciously.  Its capabilities include keylogging, remote shell, file and task management, registry editing, encoded communication, download/upload and execution. The code is available and may be incorporated into other tools.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_socelars_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND (object_name LIKE 'yesterday'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with Socelars was created. Socelars is a trojan that is disguised as a PDF reader. Socelars attempts to steal Facebook and Amazon session cookies, as well as any personal data from Facebook's Ads Manager.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_webmonitorrat_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND object_name LIKE 'revcode-persistence-module'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with WebMonitor RAT was created. WebMonitor RAT is a Remote Access Trojan (RAT). While commonly tagged by anti-virus vendors with generic detection, WebMonitor has been present since 2017. Malicious actors are limited to the developers' Command-and-Control-as-a-Service or VPN option when using WebMonitor RAT to procure sensitive information or perform tasks on the compromised host.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_poetrat_registry": {
            "query": "SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') AS last_modified FROM registry WHERE key LIKE '%\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\RUN' AND data LIKE '%\\Python37\\pythonw.exe%\\Python37\\launcher.py%'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "Registry keys associated with PoetRAT were created. PoetRAT is a Python-based remote administration tool delivered via emails with malicious DOC files attached. This threat is capable of recording keystrokes, downloading additional files, executing commands, using the webcam and more.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_poetrat_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.path LIKE '%\\Python37\\smile_funs.py' OR f.path LIKE '%\\Python37\\frown.py' OR f.path LIKE '%\\Python37\\smile.py' OR f.path LIKE %Users\\Public\\Milan%\\config.lua OR f.path LIKE %Users\\Public\\Mew\\%pythonw.exe); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with PoetRAT was detected. PoetRAT is a Python-based remote administration tool delivered via emails with malicious DOC files attached. This threat is capable of recording keystrokes, downloading additional files, executing commands, using the webcam and more.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_astaroth_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time FROM file f JOIN hash h ON f.path=h.path WHERE f.path LIKE 'C:\\Users\\%\\AppData\\Roaming\\%%\\sqlite3.dll' AND f.directory LIKE regex_match(f.directory, '.*AppData\\\\Roaming\\\\[A-Z]{3}[0-9]{11}[A-Z]', 0) AND f.filename LIKE 'sqlite3.dll'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with Astaroth was detected. Astaroth is infostealer malware that has evolved over time to leverage living-off-the-land evasion techniques while remaining fileless in its execution. Most recently, it uses legitimate Windows binary ExtExport.exe to load malicious DLL's.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_nanocorerat_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time FROM file f JOIN hash h ON f.path=h.path WHERE f.path LIKE 'C:\\Users\\%\\AppData\\Roaming\\%%\\run.dat' AND f.directory LIKE regex_match(f.directory, '.*AppData\\\\Roaming\\\\[A-F0-9]{8}-[A-F0-9]{4}-[A-F0-9]{4}-[A-F0-9]{4}-[A-F0-9]{12}', 0) AND f.filename LIKE 'run.dat'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with NanoCore RAT was detected. NanoCore RAT is a Remote Access Trojan (RAT) that has many capabilities including arbitrary command execution, file exfiltration, keylogging, and interacting with peripherals such as webcams.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_njrat_filepath": {
            "query": "SELECT key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') as last_modified FROM registry WHERE key LIKE 'HKEY_USERS\\%\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\RUN' AND name LIKE regex_match(name, '[a-f0-9]{32}', 0) AND data LIKE regex_match(data, '.*\\\\AppData\\\\Local\\\\Temp\\\\(svchost|system)\\.exe', 0); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with njRAT was detected. njRAT is a Remote Access Trojan (RAT) that has many capabilities including arbitrary command execution, file exfiltration, keylogging,and interacting with peripherals such as webcams.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_zerocleare_registry": {
            "query": "SELECT key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') as last_modified FROM registry WHERE key LIKE 'HKEY_LOCAL_MACHINE\\SYSTEM\\CONTROLSET001\\SERVICES\\SOYDSK'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A registry key associated with ZeroCleare was created. ZeroCleare is a destructive wiper damaging disk partitions and overwriting the Master Boot Record (MBR) of infected machines.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_scartrojan_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time FROM file f JOIN hash h ON f.path=h.path WHERE (f.path LIKE 'C:\\Users\\%\\AppData\\Roaming\\%%\\MsdUpdate.exe' OR f.path LIKE 'C:\\Users\\%\\AppData\\Roaming\\%%\\DysonPart.exe' OR f.path LIKE 'C:\\Users\\%\\AppData\\Roaming\\%%\\SmartMega.exe') AND f.directory LIKE regex_match(f.directory, '.*AppData\\\\Roaming\\\\(SmartMega|MSDUpdate|DysonPart)',0) AND f.filename LIKE regex_match(f.filename,'(MsdUpdate|DysonPart|SmartMega)\\.exe',0); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with SCAR Trojan was detected. SCAR Trojan is a dropper malware that is part of a botnet and calls out to command and control (C2) servers to download additional paylaods. This Trojan is associated with APT33 which use destructive techniques such as disk wiping.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_maze_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time FROM file f JOIN hash h ON f.path=h.path WHERE f.path LIKE 'C:\\Users\\DECRYPT-FILES.txt' AND f.filename LIKE 'DECRYPT-FILES.txt'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with Maze was detected. Maze is a ransomware that has been used in high-profile, targeted attacks. Attackers using Maze have demanded payment to recover the encrypted files and threaten public disclosure of stolen files if victims do not pay. \n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_prolock_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE 'C:\\ProgramData\\WinMgr.bmp'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with Prolock was detected. Prolock is a ransomware that is a rebrand of the PwndLocker ransomware. Prolock targets enterprise networks and demands ransoms of anywhere between $175K - $660K. It attempts to encrypt any file that it deems is not used for the system, and a ransom note will be dropped in every folder that contains an encrypted file. The ransomware is kept embedded in a bitmap image and is extracted when an actor with full system access executes a script to extract the ransomware from the bitmap and execute it in memory.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_ragnarlocker_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE 'RGNR_%' OR f.path LIKE '%.ragnar_%'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with Ragnar Locker was detected. Ragnar Locker is ransomware hidden within a virtual machine to avoid endpoint detection. An MSI package deploys an old version of VirtualBox responsible for starting the virtual machine in a headless mode that is hidden from the user.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_pipemon_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time FROM file f JOIN hash h ON f.path=h.path WHERE (f.path LIKE 'C:\\Windows\\System32\\spool\\prtprocs\\x64\\EntAppsvc.dll' OR f.path LIKE 'C:\\Windows\\System32\\spool\\prtprocs\\x64\\epcprtsvc.dll' OR f.path LIKE 'C:\\Windows\\System32\\spool\\prtprocs\\x64\\DEment.dll' OR f.path LIKE 'C:\\Windows\\System32\\spool\\prtprocs\\x64\\Interactive.dll'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with PipeMon Trojan was detected. PipeMon Trojan is a modular backdoor whose payloads are DLLs and are stored where Windows Print Processors are located. After the payloads are placed in this location, they are registered as Print Processors.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_asyncrat_mutex_detected": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND object_name LIKE 'AsyncMutex_%' OR object_name LIKE '!%MTX!%' ESCAPE '!'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex known to be associated with AsyncRAT was seen being created on the system. AsyncRAT is a Remote Access Tool (RAT) designed to remotely monitor and control targeted computers through an encrypted connection. The tool itself is open source and written in Microsoft's C# language. \n",
            "platform": [
                "windows"
            ]
        },
        "malware_indigodrop_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time FROM file f JOIN hash h ON f.path=h.path WHERE f.path LIKE 'C:\\Users\\%\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\anything.exe'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with IndigoDrop was detected. IndigoDrop is a modular trojan that is known to be distributed by malicious documents, the file detected is used as persistence.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_valak_registry": {
            "query": "SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') AS last_modified  FROM registry  WHERE key LIKE 'HKEY_CURRENT_USER\\SOFTWARE\\APPLICATIONCONTAINER\\APPSW64'  AND (name LIKE 'ShimV4' OR name LIKE 'SetupServiceKey'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A registry key associated with Valak was created. Valak is a modular trojan that can load malware and leverage many of its own plugins to perform activities such as information stealing. Valak uses the registry to store different components used in later execution.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_nephilim_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE ((f.directory LIKE 'C:\\Users\\%%' AND (f.filename LIKE regex_match(f.filename, '\\S+\\.(N|M)E(PH|F)(I|1)L(I|1)(N|M)$', 0) OR f.filename LIKE regex_match(f.filename, '\\S+\\.OFFWHITE$', 0) OR f.filename LIKE regex_match(f.filename, '\\S+\\.TELEGRAM$', 0) OR f.filename LIKE regex_match(f.filename, '\\S+\\.SIGARETA$', 0) OR f.filename LIKE regex_match(f.filename, '\\S+\\.TRAPGET$', 0))) OR (f.directory = 'C:' AND (f.filename LIKE regex_match(f.filename, 'NE(PH|F)(I|1)L(I|1)(N|M)-(README|DECRYPT)\\.\\S+', 0) OR f.filename LIKE regex_match(f.filename, 'OFFWHITE-MANUAL\\.\\S+', 0) OR f.filename LIKE regex_match(f.filename, 'TELEGRAM-RECOVER\\.\\S+', 0) OR f.filename LIKE regex_match(f.filename, 'SIGARETA-RESTORE\\.\\S+', 0) OR f.filename LIKE regex_match(f.filename, 'TRAPGET-INSTRUCTION\\.\\S+', 0))));  ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with Nephilim was detected. Nephilim, also called Nefilim, is a ransomware used in targeted attacks, particularly against oil and energy companies. It is usually delivered via vulnerable RDP services. The encryption is done with a combination of AES-128 for the files and RSA-2048 to encrypt the AES key. After infection, encrypted files are given one of the following extensions - .NEFILIM, .NEF1LIM, .NEPHILIM, .MEFILIN, .NEPHILIN, .TELEGRAM, .OFFWHITE, .SIGARETA and .TRAPGET\n",
            "platform": [
                "windows"
            ]
        },
        "tool_lazagne_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE 'C:\\Users\\%\\AppData\\Local\\Temp\\%\\laZagne%'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with LaZagne was detected. LaZagne is a post-exploitation, open-source tool used to recover stored passwords on a system. The LaZagne executables are Python scripts bundled with the necessary dependencies using Pyinstaller. It has been used in various espionage campaigns, particularly those targeting the Middle East, Hong Kong and the US.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_nephilim_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND (object_name LIKE 'sofos delaet sosos' OR object_name LIKE '%plyvut v karmany rekoy. My khodim po krayu nozha' OR object_name LIKE 'ONA MOYA ROZA I YA EE LUBLUUUUUUUU%' OR object_name LIKE 'na mne prigaet zhopa, pamc, pamc, pamc%' OR object_name LIKE '%sina, ti bezdelnik. a mne kak to pohui%'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with Nephilim was detected. Nephilim, also called Nefilim, is a ransomware used in targeted attacks, particularly against oil and energy companies. It is usually delivered via vulnerable RDP services. The encryption is done with a combination of AES-128 for the files and RSA-2048 to encrypt the AES key. After infection, encrypted files are given the .NEFILIM or .NEPHILIM extension.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_vidar_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE 'C:\\ProgramData\\%\\files\\%' AND f.filename IN ('passwords.txt', 'information.txt', 'outlook.txt', 'Soft'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with Vidar was detected. Vidar is an information stealer that has been used by threat actors along with GandCrab. Vidar uses encrypted strings for file paths, browser names, wallets and the names of the applications that it targets, such as Telegram. Vidar is capable of stealing cookies, usernames, passwords, card details and other system information. The gathered data is later zipped and sent to a command and control (C2) server.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_strongpity3_registry": {
            "query": "SELECT key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') as last_modified FROM registry WHERE ((key LIKE '%\\SYSTEM\\CurrentControlSet\\Services\\dusntask' OR key LIKE '%\\System\\CurrentControlSet\\Services\\PickerSrv' OR key LIKE '%\\System\\CurrentControlSet\\Services\\netplviz') AND name LIKE '%ImagePath') OR (key LIKE 'HKEY_USERS\\%\\Software\\Microsoft\\Windows\\CurrentVersion\\Run' AND name = 'OperaSyncService'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "This query detects the presence of a registry key/dataname combination known to be created during StrongPity3 execution. StrongPity3 is a spyware capable of detecting and altering anti-malware protections and exfiltration data. It uses the Registry to achieve persistence.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_lemonduck_filepath_detected": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.path LIKE 'C:\\Users\\%%\\Local\\Temp\\%') AND (f.filename LIKE 'if.bin' OR f.filename LIKE 'kr.bin' OR f.filename LIKE 'mr6.bin.exe.ori'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A file path associated with Lemon Duck was detected. Lemon Duck is a mining botnet with automated spreading capabilities. It drops several payloads on the system that are capable of mining Monero and spreading across a network using Mimikatz.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_strongpity3_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.path LIKE 'C:\\Windows\\SysWOW64\\IpOve32.exe' OR f.path LIKE 'C:\\System32\\IpOve32.exe' OR f.path LIKE 'C:\\Windows\\System32\\IpOve32.exe' OR f.path LIKE 'C:\\Windows\\SysWOW64\\netplviz.exe' OR f.path LIKE 'C:\\System32\\netplviz.exe' OR f.path LIKE 'C:\\Windows\\System32\\netplviz.exe' OR f.path LIKE 'C:\\Documents and Settings\\%\\Local Settings\\Temp\\%\\evntwn32.xml' OR f.path LIKE 'C:\\Users\\%\\AppData\\Local\\Temp\\%\\evntwn32.xml' OR f.path LIKE 'C:\\Windows\\System32\\rmaserv.exe' OR f.path LIKE 'C:\\Windows\\System32\\winprint32.exe' OR f.path LIKE 'C:\\Users\\%\\AppData\\Local\\Temp\\%\\mssqldbserv.xml' OR f.path LIKE 'C:\\Windows\\SysWOW64\\dusntask.exe' OR f.path LIKE 'C:\\Windows\\SysWOW64\\dusntask.exe' OR f.path LIKE 'C:\\Windows\\SysWOW64\\winpickr.exe' OR f.path LIKE 'C:\\Users\\%\\AppData\\Local\\Temp\\%\\ntuis32.exe' OR f.path LIKE 'C:\\Windows\\Temp\\%\\ntuis32.exe' OR f.path LIKE 'C:\\Windows\\SysWOW64\\consent32.exe' OR f.path LIKE 'C:\\Users\\%\\AppData\\Local\\Temp\\Opera\\srvolpsm.exe' OR f.path LIKE 'C:\\Users\\%\\AppData\\Local\\Temp\\Opera\\sivsnui.exe' OR f.path LIKE 'C:\\Users\\%\\AppData\\Local\\Temp\\Opera\\intervpnmix2.exe'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with StrongPity3 was created. StrongPity3 is a spyware capable of detecting and altering anti-malware protections and data exfiltration.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_prometei_registry": {
            "query": "SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') AS last_modified FROM registry WHERE (key LIKE '%SOFTWARE\\Microsoft\\Fax' AND name LIKE 'EncryptedMachineKeyId'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A registry entry associated with the Prometei botnet was detected. Prometei is a botnet that also contains malicious capabilities such as credential stealing, Monero mining, and lateral movement.\n",
            "platform": [
                "linux"
            ]
        },
        "ransomware_darkside_filepath": {
            "query": "SELECT DISTINCT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE ((f.path LIKE 'C:\\Users\\%%' AND f.filename LIKE regex_match(f.filename, 'README\\.[a-zA-Z0-9]{8}\\.TXT', 0)) OR (f.path LIKE 'C:\\Users\\%%' AND f.filename LIKE regex_match(f.filename, 'LOG\\.[a-zA-Z0-9]{8}\\.TXT', 0))); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with DarkSide was created. DarkSide is a ransomware capable of encrypting local drives and network shares. It is also capable of encrypting a specific directory that is passed to it through a command-line argument. It inhibits system recovery by deleting shadow copies.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_lockbit_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.path LIKE '%.lockbit' OR f.path LIKE '%.abcd'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "LockBit is a ransomware used in targeted attacks. It attempts to use the VBC (Visual Basic Compiler) utility, which is a signed Microsoft executable, to compile and execute code on the fly. If the vbc.exe file is not found, LockBit downloads a copy of the legitimate executable from a malicious URL. LockBit also creates a ransom note called Restore-My-Files.txt in every directory. After infection, encrypted files are given the .lockbit or .abcd extension.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_hakbit_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE (object_type='Mutant' AND object_name LIKE 'c1a76b5a-12ab-45c5-b9d9-d692faa6e7a2'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with Hakbit was created. Hakbit is a ransomware capable of evading sandbox analysis, deleting shadow copies, killing unwanted processes, moving laterally, encryption and data exfiltration. \n",
            "platform": [
                "windows"
            ]
        },
        "malware_nokki_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.path LIKE 'C:\\Users\\%\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup' OR f.path LIKE 'C:\\Users\\%\\AppData\\Local\\MicroSoft Update%' OR f.path LIKE 'C:\\Users\\%\\AppData\\Local\\Temp') AND (f.filename LIKE 'Antdule.lnk' OR f.filename LIKE 'svServiceUpdate.exe' OR f.filename LIKE 'uplog.tmp'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "KONNI and NOKKI are Remote Administration Tools (RATs) involved in a series of attacks focused on politically-motivated victims in the Korean peninsula, Eurasia and Southeast Asia. Due to code similarities and overlapping infrastructure, researchers suspect NOKKI and KONNI were developed by the same malicious actors. The payload is usually delivered via emails with attachments.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_lodarat_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC')  AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC')  AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC')  AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC')  AS creation_time  FROM file f JOIN hash h ON f.path=h.path  WHERE f.path LIKE 'C:\\Users\\%\\AppData\\Roaming\\Windata\\%.exe'; AND f.filename LIKE regex_match(f.filename, '([a-zA-Z]{6}|svchost)\\.exe', 0); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with LodaRAT was detected. LodaRAT is a Remote Access Trojan (RAT) capable of keylogging, capturing audio, and taking screenshots.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_funicorn_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch', 'UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.directory LIKE 'C:\\Users\\%%' AND f.filename LIKE regex_match(f.filename, '\\S+\\.fuckunicornhtrhrtjrjy$', 0)); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with FuckUnicorn ransomware was detected. FuckUnicorn has been targeting computers in Italy by tricking victims into downloading a fake contact tracing app, named Immuni, that promises to provide real-time updates for the COVID-19 outbreak. Upon executing the malware it displays a fake Coronavirus Map from the Center for Systems Science and Engineering at Johns Hopkins University. The ransomware adds the .fuckunicornhtrhrtjrjy extensions to names of encrypted files.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_eccentricbandwagon_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch', 'UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE ((f.directory LIKE 'C:\\Users\\%\\AppData\\Local\\Temp\\Downloads' AND f.filename LIKE regex_match(f.filename, 'tmp_\\S+_(0[1-9]|1[0-2])(0[1-9]|[1-2]\\d|3[0-1])_(2[0-3]|[01]\\d)[0-5]\\d[0-5]\\d$', 0)) OR (f.directory LIKE 'C:\\Users\\%\\AppData\\Local\\Temp\\GoogleChrome' AND f.filename LIKE regex_match(f.filename, 'chromeupdater_ps_\\d{4}(0[1-9]|1[0-2])(0[1-9]|[1-2]\\d|3[0-1])_(2[0-3]|[01]\\d)[0-5]\\d[0-5]\\d_\\d{3}_\\d{1,4}$', 0)) OR (f.directory LIKE 'C:\\Users\\%\\AppData\\Local\\Temp\\TrendMicroUpdates' AND f.filename LIKE regex_match(f.filename, 'update_(0[1-9]|1[0-2])(0[1-9]|[1-2]\\d|3[0-1])_(2[0-3]|[01]\\d)[0-5]\\d[0-5]\\d$', 0))); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with EccentricBandwagon RAT was detected. This family of malware is used as a reconnaissance tool and some variants have keylogging and screen capture functionality.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_nibiru_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch', 'UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.directory LIKE 'C:\\Users\\%%' AND f.filename LIKE regex_match(f.filename, '\\S+\\.Nibiru$', 0)); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with Nibiru ransomware was detected. It adds a .Nibiru extension to names of encrypted files.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_mabezat_filepath_detected": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.filename LIKE 'zpharaoh.exe' AND f.path LIKE 'C:\\'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A file path associated with Mabezat has been detected. Mabezat is a worm that infects Windows executable files and can be spread through email attachments, network shared drives, USB drives and CD burning. It contains capabilities of downloading and executing additional payloads from a command and control server.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_arcane_filepath_detected": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.filename LIKE 'U3LZDGVTLKNOYXJBXQ' AND f.directory LIKE '%\\Users\\%\\AppData\\Local'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A file path associated with Arcane was created. Arcane is a .NET information stealer that collects and extracts information regarding cryptocurrency wallets, instant messaging sessions, and browser information.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_chthonic_mutex_detected": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND (object_name LIKE 'TmpNtMutex' OR object_name LIKE 'NtMute' OR object_name LIKE 'SystemMutex' OR object_name LIKE '\\{03B8A4CD-37A3-3A5D-99BA-2F2544D2A32F\\}' OR object_name LIKE '\\{B4810E6F-2321-7F0D-1818-CCDBE577D2BD\\}' OR object_name LIKE '\\{B4810E6F-2321-770D-1818-CCDBE577D2BD\\}' OR object_name LIKE '\\{FB8C1EB1-2376-7F0D-C608-C1943B67DFF2\\}') ; ",
            "interval": 86400,
            "snapshot": true,
            "description": "Chthonic is a Remote Access Tool (RAT) that has evolved from Zeus. It may be delivered either through the Andromeda botnet or by phishing emails containing a malicious document as part of a targeted attack. Once executed, the main loader begins downloading additional components to expand its arsenal. Modules include capabilities to collect system information, steal passwords, keylogging and video capture from the webcam or screen. Chthonic is primarily aimed at stealing credentials for online banking, targeting over 150 banks and twenty payment systems across fifteen countries. The primary targets include the UK, Spain, the US, Russia and Japan.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_blackice_mutex_detected": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND object_name LIKE '%blackicemutex%'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with Blackice has been detected. Blackice is a worm that spreads via infecting Office documents such as Excel or Word. It can also spread by making copies of itself on local and shared drives.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_zebrocy_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.directory LIKE 'C:\\Users\\%\\AppData\\Roaming\\Personalization\\EUDC\\Policies' OR f.directory LIKE 'C:\\Users\\%\\AppData\\Roaming\\UserData\\Multimedia\\Policies' AND f.filename LIKE regex_match(f.filename, '^\\d{40}$', 0));  ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with Zebrocy was detected. Zebrocy is a backdoor that is capable of exfiltrating the infected system's information such as MAC address and hostname to the C2 and accept commands from C2 to perform other activities such as command execution.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_flowerpower_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.directory LIKE 'C:\\Users\\%\\AppData\\Roaming\\%' AND f.path LIKE regex_match(f.path, '.*\\\\AppData\\\\Roaming\\\\(\\S+)\\\\\\1\\.hwp$', 0)); \n",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with FlowerPower was detected. FlowerPower is a PowerShell script that is capable of collecting system information - items in Recent, Program Files, Program Files (x86) folders, systeminfo command output and list of running processes (through tasklist command). The collected information is stored in a .hwp file in a sub-directory within %APPDATA%. It is then exfiltrated to the C2. It is also capable of executing encoded commands received from the C2.",
            "platform": [
                "windows"
            ]
        },
        "malware_pierogi_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.directory='C:\\ProgramData' AND (f.filename='GUID.bin' OR f.filename='SyncDownOptzHostProc.exe'));  ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with Pierogi was detected. Pierogi is a backdoor capable of collecting and exfiltrating infected host information, uploading screenshots and executing malicious commands sent by the C2. It also establishes persistence through the Startup folder.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_lokibot_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime,'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE 'C:\\Users\\Public\\%' AND f.path LIKE regex_match(f.path,'C:\\\\Users\\\\Public\\\\(Natso\\.bat|cde\\.bat|x\\.bat|x\\.vbs)',0); ",
            "interval": 86400,
            "snapshot": true,
            "description": "Lokibot is one of the most well-known information stealers on the malware landscape. The actors behind Lokibot usually have the ability to steal multiple types of credentials and other sensitive information. Recent campaigns utilize a complex, multi-stage, multi-layered dropper to execute Lokibot on the victim machine. \n",
            "platform": [
                "windows"
            ]
        },
        "malware_trickbot_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime,'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE 'C:\\Users\\%\\AppData\\Local\\Temp\\%.tmp' AND f.path LIKE regex_match(f.path,'C:\\\\Users\\\\.+\\\\AppData\\\\Local\\\\Temp\\\\log[A-F0-9]{4,6}\\.tmp',0); ",
            "interval": 86400,
            "snapshot": true,
            "description": "Trickbot is a banking trojan. It has been rapidly evolving since it first appeared in late 2016. The malware's authors continue to extend its functionality through the addition of new modules to load upon infection.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_tmanger_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch', 'UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.directory LIKE 'C:\\Users\\%\\AppData\\Local\\Temp' AND f.filename='Rahoto.exe'); \n",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with Tmanger RAT was detected. Its manner of persistence depends on its elevation level. Under admin, it drops a DLL in SysWOW64 satisfying the regex [a-z]{4}\\.dll and creates a service based on it. Under non-admin, it drops a DLL into Temp directory and sets CurrentVersion\\Run registry key to it. The dropped file contains encrypted C2 config data. The RAT is capable of launching processes, manipulating and exfiltrating files, screen capture and keylogging.",
            "platform": [
                "windows"
            ]
        },
        "malware_electrorat_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch', 'UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.directory LIKE 'C:\\Users\\%\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup' AND f.filename='mdworker.lnk'); \n",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with ElectroRAT RAT was detected. ElectroRAT is written in Golang. It is capable of keylogging, taking screenshots, uploading files from disk, downloading files and executing commands on the infected host. It is known to be embedded within cryptocurrency trade management applications - 'Jamm' and 'eTrade' and a cryptocurrency poker app - 'DaoPoker'. ElectroRAT runs hidden in the background as 'mdworker'.",
            "platform": [
                "windows"
            ]
        },
        "ransomware_mountlocker_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE '%RecoveryManual.html'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with Mount Locker was detected. Mount Locker is a ransomware that began breaching corporate networks and demanding high ransom payments since, at least, July 2020. Aside from encrypting files on the infected systems, Mount Locker also steals unencrypted files and threatens victims with publishing them if the ransom is not paid. Mount Locker uses ChaCha20 to encrypt the files and RSA-2048 to encrypt the key. \n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_djvu_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.filename IN ('updatewin.exe', 'updatewin1.exe', 'updatewin2.exe') AND f.path LIKE '%\\AppData\\Local\\%') OR (f.filename LIKE 'PersonalID.txt' AND f.path LIKE 'C:\\SystemID%'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "Djvu ransomware, also called STOP, is known for changing its payloads, ransom notes and the file extensions appended to encrypted files. It spreads via cracked or faked applications or updates, keygens or activators. The main payload uses a wide variety of anti-debugging and anti-emulation techniques, which includes checking the location of the system via the keyboard layout or websites.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_djvu_registry_keys": {
            "query": "SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') as last_modified FROM registry WHERE (key LIKE '%\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion%' AND name LIKE 'SysHelper') OR (key LIKE 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Schedule\\TaskCache\\Tasks' AND data LIKE '%Time Trigger Task'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "Djvu ransomware, also called STOP, is known for changing its payloads, ransom notes and the file extensions appended to encrypted files. It spreads via cracked or faked applications or updates, keygens or activators. The main payload uses a wide variety of anti-debugging and anti-emulation techniques, which includes checking the location of the system via the keyboard layout or websites.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_gootkit_registry_key": {
            "query": "SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') as last_modified FROM registry WHERE key LIKE '%\\Software\\Microsoft\\IEAK\\GroupPolicy\\PendingGPOs' AND data LIKE '%.inf'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "Gootkit is a banking trojan that has been active since 2014 and uses the Node.JS library to carry out tasks such as: email parsing, web injection, video recording, taking screenshots, stealing passwords, etc. Gootkit is usually delivered via malicious emails. To achieve persistence, Gootkit drops an INF file and then creates three values under a GroupPolicy registry key.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_inveighzero_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.path LIKE '%Users\\%%' OR f.path LIKE '%\\temp\\%') AND f.filename LIKE 'Inveigh-Log.txt'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "InveighZero is a spoofer and man-in-the-middle tool, written in C#, designed to help penetration testers and red teams to obtain credentials from Windows hosts. \n",
            "platform": [
                "windows"
            ]
        },
        "malware_osno_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.path LIKE '%\\AppData\\Roaming\\Microsoft%' OR f.path LIKE '%\\AppData\\Local\\Temp%') AND f.filename IN ('ctfmom.exe', 'Chrome updaters.exe', 'gpustats.bx', 'ran.bx', 'keys.util'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "Osno is a .NET stealer that uses video games names to lure users. The newer version is sold on forums and includes capabilities to evade antivirus software, spread through the network and record conversations using the microphone. Osno contains different open source tools, including a rootkit, a SharpExec binary for lateral movement, a wiper to destroy the victim's files and an application to steal data from the clipboard. \n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_buran_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.path LIKE '%.buran' OR f.path LIKE '%.zeppelin') AND (f.path NOT LIKE '%\\Recent' AND f.path NOT LIKE '%backup%'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "Buran is a ransomware that started targeting government agencies, educational institutionsand health-care providers since 2018. It spreads primarily via phishing emails that contain documents with macros. Some variants have also been seen spreading through malicious advertisements. Newer variants of Buran are known as Zeppelin due to their use of the word \"zeppelin\" for the file extension and the autorun registry key that it creates to achieve persistence.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_conti_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.path LIKE '%CONTI_README.txt' OR f.path LIKE '%CONTI.txt' OR f.path LIKE '%R3ADM3.txt') AND f.path NOT LIKE '%\\Recent' AND f.path NOT LIKE '%backup%'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "Conti Ransomware is known for breaching the networks of businesses and government agencies, moving laterally via SMB (Server Message Block), encrypting files and exfiltrating victim's data. The first variants use the word Conti on the ransom note and on the file extension appended to the encrypted files. More recent variants use a random file extension and create ransom notes called \"readme.txt\". To encrypt the data, Conti uses a different AES-256 encryption key per file with a hardcoded RAS-4096 public encryption key that is unique for each victim.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_pay2key_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE '%Cobalt-Client-log.txt' AND f.path NOT LIKE '%\\Recent' AND f.path NOT LIKE '%backup%'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "Pay2Key ransomware was first discovered after a series of attacks against Israeli companies. It propagates via Remote Desktop Protocol (RDP) and executes using PsExec. To communicate with the command and control (C2), Pay2Key needs to read the Server and Port keys from a configuration file. The command and control then supplies an RSA public key that is used to cipher the RC4 key used to encrypt the victim's files. Pay2Key is also known for using a log file called Cobalt-Client-log.txt during its execution. \n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_mespinoza_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE '%Readme.README'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "Mespinoza, also known as Pysa, is a ransomware known for encrypting files on the infected system, usually appending the \"pysa\" extension although some variants might use other extensions, such as \"locked\". Mespinoza is also known for storing the ransom note in theregistry, to make it persistent. After the infection it deletes itself using a dropped batch file. This ransomware generates a key for every file it encrypts.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_mespinoza_registry_keys": {
            "query": "SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') as last_modified FROM registry WHERE key LIKE 'HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System' AND name IN ('legalnoticetext', 'legalnoticecaption') AND data IN ('PYSA', 'encrypted'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "Mespinoza, also known as Pysa, is a ransomware known for encrypting files on the infected system, usually appending the \"pysa\" extension although some variants might use other extensions, such as \"locked\". Mespinoza is also known for storing the ransom note in theregistry, to make it persistent. After the infection it deletes itself using a dropped batch file. This ransomware generates a key for every file it encrypts.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_lodarat_registry_key": {
            "query": "SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') as last_modified FROM registry WHERE (key LIKE 'HKEY_USERS\\%\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run'  OR key LIKE 'HKEY_USERS\\%\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\RunMRU' OR key LIKE 'HKEY_USERS\\%\\SOFTWARE\\Win32')  AND data LIKE regex_match(data, '.+\\\\AppData\\\\Roaming\\\\Windata\\\\[A-Za-z]{6}\\.exe.*', 0); ",
            "interval": 86400,
            "snapshot": true,
            "description": "Loda RAT is a remote access trojan (RAT) written in AutoIT that has many capabilities including keylogging, webcam and microphone recording, and stealing credentials from Filezilla. \n",
            "platform": [
                "windows"
            ]
        },
        "malware_lodarat_scheduled_task": {
            "query": "SELECT name, path, action, datetime(last_run_time, 'unixepoch', 'UTC') as last_run_time FROM scheduled_tasks WHERE name LIKE regex_match(name,'[A-Za-z]{6}\\.exe', 0) AND action LIKE regex_match(action,'.+AppData\\\\Roaming\\\\Windata\\\\[A-Za-z]{6}\\.exe.*', 0); ",
            "interval": 86400,
            "snapshot": true,
            "description": "Loda RAT is a remote access trojan (RAT) written in AutoIT that has many capabilities including keylogging, webcam and microphone recording, and stealing credentials from Filezilla. \n",
            "platform": [
                "windows"
            ]
        },
        "malware_gamaredon_scheduled_task": {
            "query": "SELECT name, path, action, enabled, state, hidden, datetime(last_run_time, 'unixepoch', 'UTC') AS last_run_time, datetime(next_run_time, 'unixepoch', 'UTC') as next_run_time, last_run_time-next_run_time as time_difference  FROM scheduled_tasks  WHERE action LIKE '%wscript%%AppData\\Roaming\\%%.vbs'  AND time_difference LIKE '-840'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "Gamaredon is an APT that has been active since at least 2013. It uses trojanized application installers, self-extracting archives with common names and icons and spam emails with malicious payloads. For the first stage of infection Gamaredon uses either a Windows Batch file and/or Visual Basic Scripting (VBS). Some Gamaredon campaigns use template injection in Word documents as an initial attack vector, which is usually delivered via a spear phishing email. \n",
            "platform": [
                "windows"
            ]
        },
        "malware_gamaredon_registry_key": {
            "query": "SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') as last_modified FROM registry WHERE LOWER(key) LIKE '%\\microsoft\\windows\\currentversion\\policies\\explorer\\run' AND name IN ('OfficeSetting', 'OfficePlugin'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "Gamaredon is an APT that has been active since at least 2013. It uses trojanized application installers, self-extracting archives with common names and icons and spam emails with malicious payloads. For the first stage of infection Gamaredon uses either a Windows Batch file and/or Visual Basic Scripting (VBS). Some Gamaredon campaigns use template injection in Word documents as an initial attack vector, which is usually delivered via a spear phishing email. \n",
            "platform": [
                "windows"
            ]
        },
        "malware_obliquerat_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime,'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time,DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.path LIKE '%ProgramData\\System\\%\\%' AND f.path LIKE regex_match(f.path,'^[A-Z]:\\\\ProgramData\\\\System\\\\(Dump|Recycled)\\\\[^\\\\]+',0)) OR (f.path LIKE '%ProgramData\\tsc\\%' AND f.path LIKE regex_match(f.path,'^[A-Z]:\\\\ProgramData\\\\tsc\\\\[^\\\\]+',0)) OR (f.path LIKE '%ProgramData\\wsc\\%' AND f.path LIKE regex_match(f.path,'^[A-Z]:\\\\ProgramData\\\\wsc\\\\[^\\\\]+',0)) OR (f.path LIKE '%ProgramData\\DirecTree.txt' AND f.path LIKE regex_match(f.path,'^[A-Z]:\\\\ProgramData\\\\DirecTree.txt$',0)); ",
            "interval": 86400,
            "snapshot": true,
            "description": "ObliqueRAT is a remote access trojan (RAT) which provides the adversary controlling it with access to the files on disk, webcam, screenshots as well as the ability to install additional malware. This family of RATs is also known to exfiltrate files on removable drives and from the recycling bin. \n",
            "platform": [
                "windows"
            ]
        },
        "malware_nishang": {
            "query": "SELECT script_path, script_text, DATETIME(time, 'unixepoch', 'UTC') AS creation_time FROM powershell_events WHERE regex_match(script_text,  'New-Object\\s+System\\.Net\\.Sockets\\.TCPClient.+.GetStream\\s*\\(\\s*\\).*\\[\\s*byte\\s*\\[\\s*\\]\\s*\\].*0\\.\\.65535\\|:ASCII\\)\\.GetBytes.+.Write\\s*\\(.+.Flush\\s*\\(\\s*\\)\\s*\\}.+.Close\\s*\\(\\s*\\)', 0); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A powershell process known to the Nishang backdoor was detected. The Nishang post-exploitation framework is currently being used by malicious actors after exploiting Microsoft exchange servers through unpatched vulnerabilities according to Microsoft.",
            "platform": [
                "windows"
            ]
        },
        "malware_powercat_backdoor": {
            "query": "SELECT script_path, script_text, DATETIME(time, 'unixepoch', 'UTC') AS creation_time FROM powershell_events WHERE script_path LIKE '%raw.githubusercontent.com/besimorhino/powercat%' OR script_path LIKE '%powercat.ps1%'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A powershell process containing commands known to Powercat were detected. Powercat is a post-exploitation tool. It is currently being used by actors after compromising Microsoft Exchange servers.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_raccoon_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.directory LIKE 'C:\\Users\\%\\AppData\\LocalLow\\%' AND f.filename='nss3.dll'); \n",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with Raccoon InfoStealer was detected. It reaches out to the C2 with the infected host's encoded GUID and username. In response, it receives a DLL and zipped (containing DLLs) payloads. These are legitimate DLLs like nss3.dll which are used to steal cookies and autofill information from browsers. The family is also capable of listing installed applications, system information and stealing info from cryptocurrency wallets, etc.",
            "platform": [
                "windows"
            ]
        },
        "ransomware_cring_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime,'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time,DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.path LIKE 'C:\\%' AND f.filename LIKE '__output') OR (f.path LIKE 'C:\\Users\\%%' AND f.filename LIKE regex_match(f.filename,'.+?\\.cring$',0)); ",
            "interval": 86400,
            "snapshot": true,
            "description": "Cring is a .NET ransomware binary using AES to encrypt files with select archive format or Microsoft Office file extensions. The AES key is encrypted with an included 8192-bit RSA public key. Attempted service and process termination prior to file encryption is performed for select backup and database solutions. The ransomware binary itself will not proceed with normal operations unless given the single argument \"cc\" during runtime.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_habitsrat_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch', 'UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.directory LIKE 'C:\\Windows\\Defender' AND f.filename LIKE regex_match(f.filename, 'MsMpEng\\.(exe|dll)|Defender\\.dll', 0));\n",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with HabitsRAT malware was detected. HabitsRAT is a backdoor that allows the malware operator to execute arbitrary code on the infected machine. It copies itself into C:\\Windows\\Defender\\MsMpEng.exe. It creates a scheduled task through a XML file written in %TEMP% directory. A RSA-2048 key is used to encrypt and authenticate commands from the C2 server. The C2 server name is stored in C:\\Windows\\Defender\\Defender.dll and RSA-2048 private key is stored in C:\\Windows\\Defender\\MsMpEng.dll. ",
            "platform": [
                "windows"
            ]
        },
        "malware_saintbot_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.directory LIKE 'C:\\Users\\%\\AppData\\Local\\z_%' AND f.path LIKE regex_match(f.path, '\\S+\\\\AppData\\\\Local\\\\z_(\\S+)\\\\\\1\\.(vbs|bat)', 0));\n",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with SaintBot malware was detected. SaintBot is a downloader that is delivered via phishing email. A seemingly benign .lnk file contains malicious PowerShell code that downloads the next stage of the malware. This component drops another Windows executable that downloads two additional executables. One of the final binaries disables Windows Defender. The other is the primary malicious component that drops a copy of Ntdll.dll and sets up persistence.",
            "platform": [
                "windows"
            ]
        },
        "malware_hafnium_mailbox_export": {
            "query": "SELECT p.name, p.pid, DATETIME(p.start_time, 'unixepoch', 'UTC') AS start_time, p.cmdline FROM processes p WHERE p.parent = (SELECT pid FROM processes WHERE name  LIKE 'w3wp%') AND p.cmdline LIKE 'cmd /c %&echo [E]';  ",
            "interval": 86400,
            "snapshot": true,
            "description": "A Powershell pattern matching what malicious actors are using to export and later exfiltrate mailbox data after compromising Microsoft exchange servers after their compromise through unpatched vulnerabilities.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_necro_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND (object_name LIKE 'internationalCyberWarefare%' OR object_name LIKE 'udZ=R2y5ShB-^4S6nGgFw' OR object_name LIKE '%6829'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with the Necro Python bot was detected. Necro bot is known for targeting Linux-based and Windows operating systems and for using both Python scripts and executables created with pyinstaller. The newer version of the bot contains exploits for more than 10 different web applications and the SMB protocol. The infection starts with the exploitation of a vulnerability in one of the targeted applications or the operating systems. The bot is also capable of hiding its presence on the system by installing a user-mode rootkit designed to hide the malicious process and malicious registry entries created to ensure that the bot runs every time a user logs into the infected system. \n",
            "platform": [
                "windows"
            ]
        },
        "malware_necro_registry_key": {
            "query": "SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') as last_modified FROM registry WHERE key LIKE '%\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run' AND name LIKE 'System explore'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A registry key associated with the Necro Python bot was detected. Necro bot is known for targeting Linux-based and Windows operating systems and for using both Python scripts and executables created with pyinstaller. The newer version of the bot contains exploits for more than 10 different web applications and the SMB protocol. The infection starts with the exploitation of a vulnerability in one of the targeted applications or the operating systems. The bot is also capable of hiding its presence on the system by installing a user-mode rootkit designed to hide the malicious process and malicious registry entries created to ensure that the bot runs every time a user logs into the infected system.  \n",
            "platform": [
                "windows"
            ]
        },
        "malware_lilthrat_path": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time,  DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified,  DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time,  DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.path LIKE 'C:\\Users\\%\\AppData\\Local\\Temp\\Bginfo.bat');\n",
            "interval": 86400,
            "snapshot": true,
            "description": "A file path associated with the Lilth RAT was detected. Lilth is a RAT that is commonly associated with\nthe Sidecar APT group. Lilth is a commodity RAT that has been seen in the wild since 2016. Lilth has the\nfollowing capabilities: ability to terminate or restart itself, download and execute files, enumerate files\nand it can create a reverse shell.",
            "platform": [
                "windows"
            ]
        },
        "malware_epicenterrat_path": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time,  DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified,  DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time,  DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.path LIKE 'C:\\ProgramData\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\Myfile.js') OR (f.path LIKE 'C:\\Users\\%\\AppData\\%\\Windows\\Start Menu\\Programs\\Startup\\Myfile.js');\n",
            "interval": 86400,
            "snapshot": true,
            "description": "A file path associated with epicenterRAT was detected. epicenterRAT is a RAT commonly associated with the APT group Sidecar since 2018. It contains a variety of capabilities, in including gathering system information, taking screenshots; shutting down, rebooting, or logging off the system, and uninstalling.",
            "platform": [
                "windows"
            ]
        },
        "malware_klingonrat_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.directory LIKE 'C:\\Users\\%\\AppData\\Local\\Windows Update' AND f.filename='updater10.exe'); \n",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with Klingon RAT was detected. It is capable of killing AV processes, setting persistence and escalating privileges in multiple ways. It also has a C2 component - it can receive commands from TA including starting a reverse shell, executing programs, etc. and exfiltrate the infected host's network information.",
            "platform": [
                "windows"
            ]
        },
        "malware_biopass_rat_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.directory LIKE regex_match(f.directory, '[a-zA-Z]:\\\\Users\\\\Public\\\\BPS\\\\V[0-9]', 0) AND f.path LIKE '%:\\Users\\Public\\BPS\\') OR f.path LIKE ('%:\\Users\\Public\\ServiceHub\\ServiceHub.Host.CLR.exe');\n",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with BioPass RAT was detected. BioPass is a typical Remote Access Trojan (RAT) that has basic features such as remote desktop access, file exfiltration and command execution. It also possesses the ability to steal web browser and instant messaging client data. The file paths detected are used as an execution root folder for the malware and other downloaded malicious payloads.",
            "platform": [
                "windows"
            ]
        },
        "malware_puzzlemaker_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.directory='C:\\Windows\\System32' AND (LOWER(f.filename)='wmiprvmon.exe' OR LOWER(f.filename)='wmimon.dll')); \n",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with a RAT attributed to Puzzlemaker threat actor was detected. Two PE files are dropped into the %SYSTEM% directory. WmiPrvMon.exe is installed as a service and launches the other dropped PE, wmimon.dll which is the main payload. It contains the hardcoded C2 server URL and is capable of downloading and uploading files, creating processes and deleting itself. All communications with the C2 is encrypted. ",
            "platform": [
                "windows"
            ]
        },
        "malware_betabot_detected": {
            "query": "SELECT key AS reg_key, path, name, type, data, datetime(mtime, 'unixepoch', 'UTC') AS last_modified FROM registry WHERE key LIKE 'HKEY_USERS\\%\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce' AND data LIKE regex_match(data, '^[A-Z]:\\\\ProgramData\\\\Google Updater [0-9\\.]+\\\\[a-z0-9]+\\.exe$', 0);\n",
            "interval": 86400,
            "snapshot": true,
            "description": "This query is applicable to Windows. It detects hosts infected by Betabot. Betabot (aka Neurevt) is a trojan with capabilities such as information stealing, cryptocurrency mining and remote access. The information stealing capabilities are known to use form grabbing in browsers as well as harvesting credentials from programs such as FTP and email clients. Additionally, this malware family is known to spread via USB devices that are exposed to an infected machine.",
            "platform": [
                "windows"
            ]
        },
        "zonemap_suspicious_modification": {
            "query": "SELECT key AS reg_key, path, name, type, data, datetime(mtime, 'unixepoch', 'UTC') AS last_modified FROM registry WHERE key LIKE '%SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ZoneMap' AND (((name LIKE 'IntranetName' OR name LIKE 'ProxyBypass' OR name LIKE 'UNCAsIntranet') AND data LIKE '1') OR (name LIKE 'AutoDetect' AND data LIKE '0'));\n",
            "interval": 86400,
            "snapshot": true,
            "description": "A suspicious registry modification of Internet Zone settings may have disabled security protections. Internet Zone settings control security policies associated to downloads, scripts or ActiveX controls. Internet Zones allow to apply different policies depending on the source of the file. The intranet zone is typically considered a safe source of data. With this modification, unsafe internet sites may be considered part of the intranet zone.",
            "platform": [
                "windows"
            ]
        },
        "malware_solarmarker_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE '%:\\Users\\_%\\AppData\\Roaming\\solarmarker.dat';\n",
            "interval": 86400,
            "snapshot": true,
            "description": "Solarmarker is a malware campaign conducted with the objective to steal sensitive data such as web browser credentials and key strokes from the infected machine. The campaign uses planetry-like naming conventions such as Jupyter, Mars and Uran to name their malware modules and variants. The file detected contains an identifier that is used to uniquely identify each infected machine.",
            "platform": [
                "windows"
            ]
        },
        "malware_amadey_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.filename LIKE '%ween.exe' OR f.filename IN ('scr.dll', 'cred.dll')) AND f.path LIKE '%:\\ProgramData\\%';\n",
            "interval": 86400,
            "snapshot": true,
            "description": "Amadey is a modular infostealer known for taking screenshots and collecting credentials from the infected system. Amadey is also capable of downloading additional malware, such as ServHelper, using a PowerShell command line received from its C2 (Command and Control) servers.",
            "platform": [
                "windows"
            ]
        },
        "malware_servhelper_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE f.filename IN ('mediasvc.png', 'mediasrv.png', 'wupsvc.jpg') AND f.path LIKE '%:\\Windows\\branding\\%';\n",
            "interval": 86400,
            "snapshot": true,
            "description": "ServHelper is a backdoor used to install additional malware, such as cryptominers, infostealers and Remote Access Trojans (RAT) during attacks to financial and retail sectors. ServHelper's backdoor component relies on a modified Remote Desktop Protocol (RDP) library. Some variants of this malware drop executables with the png or jpg extensions in an attempt to disguise the payloads.",
            "platform": [
                "windows"
            ]
        },
        "malware_boxcaon_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch', 'UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.directory LIKE 'C:\\Users\\Public' AND LOWER(f.filename)='spools.exe'); \n",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with BoxCaon backdoor was detected. It contains capabilities like downloading and uploading files, running commands and sending the threat actor (TA) the results. It allows the TA to upload and execute additional tools for further reconnaissance and lateral movement. It utilizes Dropbox as a C&C server, by sending and receiving commands written to a specific folder in a specially created Dropbox account, prepared by the TA before the operation. ",
            "platform": [
                "windows"
            ]
        }
    }
}