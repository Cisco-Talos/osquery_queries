{
    "platform": "windows",
    "queries": {
        "malware_bisonal_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size,  DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time,  DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified,  DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time,  DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE 'C:\\Windows\\Tasks\\conime.exe'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A file path associated with Bisonal was created. Bisonal is a Remote Access Trojan (RAT) that usually targets government, military or other public and private organizations in South Korea, Japan and Russia. The primary infection vector is via spear phishing campaigns with malicious documents attached. Bisonal is also known for using Dynamic DNS for its Command and Control servers.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_bisonal_registry": {
            "query": "SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') AS last_modified FROM registry  WHERE (key LIKE 'HKEY_LOCAL_MACHINE\\SOFTWARE\\WOW6432NODE\\MICROSOFT\\WINDOWS NT\\CURRENTVERSION\\WINLOGON'  OR key LIKE 'HKEY_USERS\\%\\Software\\Microsoft\\Windows\\CurrentVersion\\Run' OR key LIKE 'HKEY_LOCAL_MACHINE\\SYSTEM\\CONTROLSET001\\SERVICES\\FASTUSERSWITCHINGCOMPATIBILITY\\PARAMETERS') AND (name IN ('mismyou', 'Microsofttool', 'workhelper') OR data LIKE 'netcat27.dll' OR data LIKE '%temp\\pvcu.dll%' OR data LIKE '%Windows\\Tasks\\conime.exe'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A registry key associated with Bisonal was created. Bisonal is a Remote Access Trojan (RAT) that usually targets government, military or other public and private organizations in South Korea, Japan and Russia. The primary infection vector is via spear phishing campaigns with malicious documents attached. Bisonal is also known for using Dynamic DNS for its Command and Control servers.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_azorult_registry": {
            "query": "SELECT key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') as last_modified FROM registry WHERE key LIKE '%SYSTEM%SERVICES%LOCALNETSERVICE%' AND name LIKE '%ImagePath';",
            "interval": 86400,
            "snapshot": true,
            "description": "This query detects the presence of a registry key/dataname combination known to be created during Azorult execution. Azorult is an information stealer capable of exfiltrating sensitive user data such as files, passwords, and cryptocurrency wallet keys.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_windex_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.path LIKE '%\\AppData\\Roaming\\Microsoft\\Repairs\\sha.dll' OR f.path LIKE '%\\AppData\\Roaming\\Microsoft\\Caches\\Files\\usd.dll' OR f.path LIKE '%\\AppData\\Roaming\\Microsoft\\Identities\\Administrator\\arc.dll' OR f.path LIKE '%\\AppData\\Roaming\\Microsoft\\Common\\Shared.dll' OR f.path LIKE '%\\AppData\\Roaming\\Microsoft\\Shared\\Modules\\fil.dll' OR f.path LIKE '%\\AppData\\Roaming\\Microsoft\\Windows\\Addins\\att.dll' OR f.path LIKE '%\\AppData\\Roaming\\Microsoft\\Defender\\launch.exe' OR f.path LIKE '%\\AppData\\Roaming\\Microsoft\\Messenger\\Extension\\WdExt.exe' OR f.path LIKE '%\\Windows\\SysWOW64\\mscaps.exe'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "\"A filepath associated with Windex was detected. Windex is malware found hosted on a North Korean news site and used in a watering hole attack. Various file artifacts created during runtime are dropped to the Microsoft subdirectory within APPDATA\"\n",
            "platform": [
                "windows"
            ]
        },
        "malware_dcrat_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch', 'UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE '%DCRatBuild%' OR f.path LIKE '%\\Temp\\dclib%'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with DCRat was created. DCRat is a Remote Access Trojan (RAT) capable of stealing credentials.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_ap0calypserat_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE '%Windows\\apocalyps32.exe'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with Ap0calypseRAT was created. Ap0calypseRAT is a Remote Access Trojan (RAT) capable of arbitrary command execution, keylogging, remote desktop access, and file exfiltration.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_raccoon_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND (object_name LIKE 'rc_%'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with Raccoon info stealer was created. Raccoon is a stealer that collects passwords, cookies, autofill from all popular browsers (including FireFox x64), CC data, system information, and almost all existing desktop wallets of cryptocurrencies\n",
            "platform": [
                "windows"
            ]
        },
        "malware_cryptbot_registry": {
            "query": "SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') AS last_modified FROM registry WHERE (data LIKE '%ProgramData\\Cryptbot\\margin.exe%'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A registry key associated with Cryptbot was created. Cryptbot is a trojan designed to steal passwords, cryptowallets, browser credentials, and other information.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_proyectorat_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.path LIKE '%\\AppData\\Roaming\\LocalAdmin\\Conf.ini' OR f.path LIKE '%\\AppData\\Roaming\\LocalOffice\\Conf.ini' OR f.path LIKE '%\\AppData\\Roaming\\Office\\Conf.ini' OR f.path LIKE '%\\AppData\\Roaming\\AgentLog\\Conf.ini' OR f.path LIKE '%\\AppData\\Roaming\\AgentLogs\\Conf.ini' OR f.path LIKE '%\\AppData\\Roaming\\Sys'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with Proyecto RAT was detected. Proyecto RAT is a remote administration tool delivered via emails with malicious RTF files attached. This threat is capable of recording keystrokes, downloading additional files, executing commands, using the webcam and more. The latest campaign uses a disposable email service called YOPmail as its command and control, and targets financial institutions and government agencies in South America.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_ryuk_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE '%RyukReadMe.txt' OR f.path LIKE '%RyukReadMe.html' OR f.path LIKE '%RyukReadMe.lnk'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with Ryuk was detected. Ryuk is a ransomware known for targeting large organizations and asking for rather large ransom payments to recover the encrypted files. The infection has been associated with emails that contain malicious attachments that first deliver Emotet, which is used to deliver modular payloads such as Ryuk. \n",
            "platform": [
                "windows"
            ]
        },
        "malware_sality_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND object_name LIKE '%.exeM_%_'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with Sality was created. Sality is a polymorphic file infector and one of the most resilient malware in the threat landscape. Once a Sality sample bypasses perimeter security, its goal is to download and execute additional malware components. To avoid infecting the same process multiple times, Sality creates a mutex with the process name and the decimal representation of the process ID.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_proyectorat_registry": {
            "query": "SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') AS last_modified FROM registry WHERE (key LIKE '%\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\RUN' OR key LIKE '%\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\RUNONCE') AND data LIKE '%\\AppData\\Roaming\\LocalAdmin\\%.exe' OR data LIKE '%\\AppData\\Roaming\\LocalOffice\\%.exe' OR data LIKE '%\\AppData\\Roaming\\Office\\%.exe' OR data LIKE '%\\AppData\\Roaming\\AgentLogs\\%.exe' OR data LIKE '%\\AppData\\Roaming\\AgentLog\\%.exe'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "Registry keys associated with Proyecto RAT were created. Proyecto RAT is a remote administration tool delivered via emails with malicious RTF files attached. This threat is capable of recording keystrokes, downloading additional files, executing commands, using the webcam and more. The latest campaign uses a disposable email service called YOPmail as its command and control, and targets financial institutions and government agencies in South America.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_betabot_registry": {
            "query": "SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') AS last_modified FROM registry WHERE (key LIKE '%\\SOFTWARE\\WIN7ZIP' AND name LIKE 'Uuid'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A registry key associated with BetaBot was created. BetaBot, also known as Neurevt, is a botnet with a large number of capabilities, such as downloading additional malware, stealing banking data, DDoS attacks and website sniffing. Modules for a rootkit and a crypto-currency miner were added in recent years. It also attempts to disable security-related applications and even blocks some code injection techniques and other malicious activity to prevent other malware from running on the system.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_ryuk_registry": {
            "query": "SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') AS last_modified FROM registry WHERE key LIKE '%\\Software\\Microsoft\\Windows\\CurrentVersion\\Run' AND name LIKE 'svchos'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A registry key associated with Ryuk was created. Ryuk is a ransomware known for targeting large organizations and asking for rather large ransom payments to recover the encrypted files. The infection has been associated with emails that contain malicious attachments that first deliver Emotet, which is used to deliver modular payloads such as Ryuk. To achieve persistence, Ryuk adds a registry key to execute itself at every login.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_netwirerat_registry": {
            "query": "SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') AS last_modified FROM registry WHERE key LIKE '%SOFTWARE\\NETWIRE'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A registry key associated with NetWire RAT was created. NetWire is a publicly available, multiplatform remote administration tool (RAT) that has been used by criminal and APT groups. Although it includes remote control capabilities, its functionality seems focused on password stealing and keylogging. Newer variants of NetWire are capable of scraping credit card data and reading data from connected USB devices.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_glupteba_registry": {
            "query": "SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') AS last_modified FROM registry  WHERE key LIKE 'HKEY_USERS\\%\\SOFTWARE\\MICROSOFT\\TESTAPP'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A registry key associated with Glupteba was created. Glupteba is malware providing easy botnet management. It is capable of stealing credentials, collecting system information, and adding the infected machine to it's botnet.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_vilsel_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND object_name LIKE 'Pro3'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with Vilsel was created. Vilsel is a trojan that is capable of downloading additional malware, and modifying system configurations. \n",
            "platform": [
                "windows"
            ]
        },
        "malware_smominru_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND object_name LIKE 'Windows 10 Pro02'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with Smominru was created. Smominru (also known as MyKings) is a botnet that uses a trojan with a modular design for spreading. Based on the modules installed, Smominru is capable of lateral movement exploiting known vulnerabilities such as EternalBlue, brute-forcing services such as RDP, stealing credentials, and mining cryptocurrency.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_revengerat_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND object_name LIKE '%RV_MUTEX%'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with RevengeRAT was created. RevengeRAT is a Remote Access Trojan (RAT) capable of stealing credentials, executing commands, manipulating system configurations, and interacting with peripherals. \n",
            "platform": [
                "windows"
            ]
        },
        "malware_plasmarat_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND (object_name LIKE '4919245' OR object_name LIKE '3818273' OR object_name LIKE '83729184726481' OR object_name LIKE '48727194728194'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with PlasmaRAT was created. PlasmaRAT is a Remote Access Trojan (RAT) that has many capabilities including mining, denial of service, remote desktop access, and keylogging. PlasmaRAT's sourcecode is freely available online and has been seen used by threat actors such as APT33.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_obliquerat_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND object_name LIKE 'Oblique'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with ObliqueRAT was created. ObliqueRAT is a Remote Access Trojan (RAT) that has many capabilities including arbitrary command execution, file exfiltration, and sandbox detection. The method of infection is malicious Microsoft Office documents containing macros.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_medusa_registry": {
            "query": "SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') AS last_modified FROM registry  WHERE key LIKE 'HKEY_USERS\\%\\Software\\MEDUSA'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A registry key associated with MedusaLocker was created. MedusaLocker is ransomware that encrypts files with the AES crypto algorithm. Persistence is established by creating a scheduled task to execute a copy of itself from the AppData Roaming folder. A notable feature of MedusaLocker is that it manipulates the registry to allow it to reach mapped network drives for encryption.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_frenchy_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND object_name LIKE 'frenchy_shellcode_%'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with Frenchy was created. Frenchy is a shellcode tool leveraged by many malware families including Emotet and AgentTesla. The tool facilitates evading detection while launching malicious processes. \n",
            "platform": [
                "windows"
            ]
        },
        "malware_blackrat_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND object_name LIKE 'qSILlzCwXBSrQ1Vb72'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with BlackRAT was created. BlackRAT is a remote access trojan (RAT) that is capable of downloading additional malware, executing commands, and exfiltration of information from the infected machine.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_ap0calypserat_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND object_name LIKE 'apocalyps32'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with Ap0calypseRAT was created. Ap0calypseRAT is a Remote Access Trojan (RAT) that has many capabilities including arbitrary command execution, keylogging, remote desktop access, and file exfiltration. The primary infection vector of Ap0calypseRAT is unknown. This RAT has shown up periodically on underground forums, and has been seen as an additional payload dropped by other malware families.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_chernolocker_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE f.path LIKE '%(.CHERNOLOCKER)' OR f.path LIKE '%(.chernolocker)' OR f.path LIKE '%(.filelocker@protonmail.ch)' OR f.path LIKE '%.(.filelocker@protonmail.ch)'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with Chernolocker was detected. ChernoLocker is ransomware using AES-256 to encrypt a victim's files and requests Bitcoin for the ransom payment. The attacker's e-mail address and choice of encrypted file extension has changed over time with each variant.\n",
            "platform": [
                "windows"
            ]
        },
        "ransomware_gandcrab_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND (object_name LIKE 'pc_group=%ransom_id%'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with Gandcrab was created. Gandcrab is a ransomware variant first observed in January 2018. It has been delivered with email spam through the Necurs botnet, RIG Exploit Kit, GrandSoft Exploit Kit, and as part of the EITest Campaign.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_limerat_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND (object_name LIKE 'C9C1EE6A969F' OR object_name LIKE '6691A1ED40AE' OR object_name LIKE 'I0xpbWVSQVQ=' OR object_name LIKE '_Lime_Worm_'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with LimeRAT was created. LimeRAT is a .NET Remote Administration Tool for Windows (RAT) with many plugins. Existing plugins provide the ability to mine the Monero (XMR) cryptocurrency, perform a Distributed Denial of Service (DDoS) attack, encrypt files on all drives including USB, steal passwords, replace cryptocurrency addresses with the attackers and more.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_quasarrat_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND (object_name LIKE 'QSR_MUTEX_%' OR object_name LIKE '123AKs82kA,ylAo2kAlUS2kYkala!' OR object_name LIKE 'MUTEX___________________'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with QuasarRAT was created. QuasarRAT is an open source 'Remote Administration Tool' that is often used maliciously.  Its capabilities include keylogging, remote shell, file and task management, registry editing, encoded communication, download/upload and execution. The code is available and may be incorporated into other tools.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_socelars_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND (object_name LIKE 'yesterday'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with Socelars was created. Socelars is a trojan that is disguised as a PDF reader. Socelars attempts to steal Facebook and Amazon session cookies, as well as any personal data from Facebook's Ads Manager.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_webmonitorrat_mutex": {
            "query": "SELECT session_id, object_name, object_type FROM winbaseobj WHERE object_type='Mutant' AND object_name LIKE 'revcode-persistence-module'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A mutex associated with WebMonitor RAT was created. WebMonitor RAT is a Remote Access Trojan (RAT). While commonly tagged by anti-virus vendors with generic detection, WebMonitor has been present since 2017. Malicious actors are limited to the developers' Command-and-Control-as-a-Service or VPN option when using WebMonitor RAT to procure sensitive information or perform tasks on the compromised host.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_poetrat_registry": {
            "query": "SELECT key AS reg_key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') AS last_modified FROM registry WHERE key LIKE '%\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\RUN' AND data LIKE '%\\Python37\\pythonw.exe%\\Python37\\launcher.py%'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "Registry keys associated with PoetRAT were created. PoetRAT is a Python-based remote administration tool delivered via emails with malicious DOC files attached. This threat is capable of recording keystrokes, downloading additional files, executing commands, using the webcam and more.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_poetrat_filepath": {
            "query": "SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time, f.type FROM file f LEFT JOIN hash h ON f.path=h.path WHERE (f.path LIKE '%\\Python37\\smile_funs.py' OR f.path LIKE '%\\Python37\\frown.py' OR f.path LIKE '%\\Python37\\smile.py'); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with PoetRAT was detected. PoetRAT is a Python-based remote administration tool delivered via emails with malicious DOC files attached. This threat is capable of recording keystrokes, downloading additional files, executing commands, using the webcam and more.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_astaroth_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time FROM file f JOIN hash h ON f.path=h.path WHERE f.path LIKE 'C:\\Users\\%\\AppData\\Roaming\\%%\\sqlite3.dll' AND f.directory LIKE regex_match(f.directory, '.*AppData\\\\Roaming\\\\[A-Z]{3}[0-9]{11}[A-Z]', 0) AND f.filename LIKE 'sqlite3.dll'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with Astaroth was detected. Astaroth is infostealer malware that has evolved over time to leverage living-off-the-land evasion techniques while remaining fileless in its execution. Most recently, it uses legitimate Windows binary ExtExport.exe to load malicious DLL's.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_nanocorerat_filepath": {
            "query": "SELECT f.path, f.directory, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime, 'unixepoch','UTC') AS last_access_time, DATETIME(f.mtime, 'unixepoch', 'UTC') AS last_modified, DATETIME(f.ctime, 'unixepoch', 'UTC') AS last_status_change_time, DATETIME(f.btime, 'unixepoch', 'UTC') AS creation_time FROM file f JOIN hash h ON f.path=h.path WHERE f.path LIKE 'C:\\Users\\%\\AppData\\Roaming\\%%\\run.dat' AND f.directory LIKE regex_match(f.directory, '.*AppData\\\\Roaming\\\\[A-F0-9]{8}-[A-F0-9]{4}-[A-F0-9]{4}-[A-F0-9]{4}-[A-F0-9]{12}', 0) AND f.filename LIKE 'run.dat'; ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with NanoCore RAT was detected. NanoCore RAT is a Remote Access Trojan (RAT) that has many capabilities including arbitrary command execution, file exfiltration, keylogging, and interacting with peripherals such as webcams.\n",
            "platform": [
                "windows"
            ]
        },
        "malware_njrat_filepath": {
            "query": "SELECT key, path, name, data, datetime(mtime, 'unixepoch', 'UTC') as last_modified FROM registry WHERE key LIKE 'HKEY_USERS\\%\\MICROSOFT\\WINDOWS\\CURRENTVERSION\\RUN' AND name LIKE regex_match(name, '[a-f0-9]{32}', 0) AND data LIKE regex_match(data, '.*\\\\AppData\\\\Local\\\\Temp\\\\(svchost|system)\\.exe', 0); ",
            "interval": 86400,
            "snapshot": true,
            "description": "A filepath associated with njRAT was detected. njRAT is a Remote Access Trojan (RAT) that has many capabilities including arbitrary command execution, file exfiltration, keylogging,and interacting with peripherals such as webcams.\n",
            "platform": [
                "windows"
            ]
        }
    }
}