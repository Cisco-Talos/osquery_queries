malware_thiefquest_filepath:
  query: 'SELECT f.path, f.directory, f.filename, h.sha256, DATETIME(f.atime, "unixepoch","UTC")
    AS last_access_time, DATETIME(f.mtime, "unixepoch", "UTC") AS last_modified, DATETIME(f.ctime,
    "unixepoch", "UTC") AS last_status_change_time, DATETIME(f.btime, "unixepoch",
    "UTC") AS creation_time  FROM file f JOIN hash h ON f.path=h.path  WHERE (f.path
    LIKE "/Library/mixednkey/toolroomd" OR f.path LIKE "/Library/AppQuest/com.apple.questd"
    OR f.path LIKE "/Library/LaunchDaemons/com.apple.questd.plist" OR f.path LIKE
    "/Users/%/Library/AppQuest/com.apple.questd" OR f.path LIKE "/Users/%/Library/LaunchAgents/com.apple.questd.plist"); '
  interval: 86400
  snapshot: true
  description: A filepath associated with ThiefQuest Ransomware was detected. ThiefQuest
    is a ransomware that has keylogging and remote command execution capabilities.
  references:
  - https://www.virustotal.com/gui/file/b34738e181a6119f23e930476ae949fc0c7c4ded6efa003019fa946c4e5b287a/detection
  mitre_tactics:
  - Defense Evasion: TA0005
  - Execution: TA0002
  - Persistence: TA0003
  mitre_techniques:
  - Plist Modification: T1150
  platform:
  - macos
