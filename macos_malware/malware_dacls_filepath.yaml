malware_dacls_filepath:
  query: 'SELECT f.path, f.filename, h.sha256, f.uid, f.gid, f.mode, f.size, DATETIME(f.atime,
    ''unixepoch'',''UTC'') AS last_access_time, DATETIME(f.mtime, ''unixepoch'', ''UTC'')
    AS last_modified, DATETIME(f.ctime, ''unixepoch'', ''UTC'') AS last_status_change_time,
    DATETIME(f.btime, ''unixepoch'', ''UTC'') AS creation_time, f.type FROM file f
    LEFT JOIN hash h ON f.path=h.path WHERE (f.path LIKE "%/Library/.mina" OR f.path
    LIKE "%/Library/LaunchAgents/com.aex-loop.agent.plist" OR f.path LIKE "%/Library/LaunchDaemons/com.aex-loop.agent.plist"); '
  interval: 86400
  snapshot: true
  description: A filepath associated with the Dacls RAT (Remote Access Trojan) was
    detected. Dacls samples contain strings that link them to the Lazarus cybercriminal
    group, that also created Dacls RAT variants for Windows and Linux. To achieve
    persistence, Dacls creates a plist (property list) file inside /Library/LaunchAgents
    or /Library/LaunchDaemons/ to run a hidden file on startup. Dacls is also known
    for its use of plugins to perform different functions, such as scanning directories,
    downloading files and sending collected logs to its command and control.
  references:
  - www.virustotal.com/gui/file/899e66ede95686a06394f707dd09b7c29af68f95d22136f0a023bfd01390ad53/detection
  - www.virustotal.com/gui/file/216a83e54cac48a75b7e071d0262d98739c840fd8cd6d0b48a9c166b69acd57d/detection
  mitre_tactics:
  - Execution: TA0002
  - Defense Evasion: TA0005
  mitre_techniques: []
  platform:
  - macos
